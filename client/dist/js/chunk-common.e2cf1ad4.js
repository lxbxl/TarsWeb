(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{"04b0":function(e,t,a){"use strict";var o=a("a4e9"),s=a.n(o);s.a},"0a5e":function(e,t,a){e.exports=a.p+"img/zoom-in.a42f35f1.svg"},"0abb":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"compare-chart"},[a("ve-line",e._b({},"ve-line",e.chartOptions,!1)),a("a",{staticClass:"compare-chart-zoom-in",attrs:{href:"javascript:"},on:{click:function(t){e.enlarge=!0}}},[a("icon",{attrs:{name:"zoom-in"}})],1),a("let-modal",{attrs:{width:"80%"},on:{close:function(t){e.enlarge=!1}},model:{value:e.enlarge,callback:function(t){e.enlarge=t},expression:"enlarge"}},[e.enlarge?a("ve-line",e._b({},"ve-line",e.largeChartOptions,!1)):e._e(),a("div",{attrs:{slot:"foot"},slot:"foot"})],1)],1)},s=[],r=(a("4160"),a("b0c0"),a("159b"),a("a026")),n=(a("627c"),a("0a6d"),a("ba1a")),i=a.n(n);r["default"].component(i.a.name,i.a);a("0a5e");var l={props:{title:String,timeColumn:String,dataColumns:Array,data:Array},data:function(){return{enlarge:!1}},computed:{chartOptions:function(){var e={},t=[this.timeColumn];return this.dataColumns.forEach((function(a){var o=a.name,s=a.label;e[o]=s,t.push(o)})),{title:{show:!0,text:this.title},grid:{bottom:40,top:50},legend:{top:5},colors:["#f56c77","#6accab"],settings:{labelMap:e,scale:[!0,!1],lineStyle:{width:1}},data:{columns:t,rows:this.data}}},largeChartOptions:function(){var e={},t=[this.timeColumn];return this.dataColumns.forEach((function(a){var o=a.name,s=a.label;e[o]=s,t.push(o)})),{title:{show:!0,text:this.title},grid:{bottom:40,top:50},legend:{top:5},colors:["#f56c77","#6accab"],settings:{labelMap:e,scale:[!0,!1],lineStyle:{width:1}},data:{columns:t,rows:this.data},dataZoom:[{type:"inside",minValueSpan:12,zoomOnMouseWheel:"alt"},{minValueSpan:12}]}}}},c=l,d=(a("29ab"),a("2877")),u=Object(d["a"])(c,o,s,!1,null,null,null);t["a"]=u.exports},"0b18":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hours-filter"},[a("h4",[e._v(e._s(e.title))]),a("ul",e._l(e.hours,(function(t){return a("li",{key:t.val,class:{active:t.val===e.value},on:{click:function(a){return e.onChange(t.val)}}},[e._v(e._s(t.txt)+" ")])})),0)])},s=[],r=(a("99af"),a("d81d"),a("fb6a"),a("a9e3"),Array.apply(null,{length:24}).map((function(e,t){return t}))),n=r.map((function(e){return{val:e,txt:"0".concat(e).slice(-2)}})),i=[{val:-1,txt:"all"}].concat(n),l={name:"HoursFilter",props:{title:{type:String,default:""},value:Number},filters:{format:function(e){return"0".concat(e).slice(-2)}},data:function(){return{hours:i}},methods:{onChange:function(e){this.$emit("input",e)}}},c=l,d=(a("25d5"),a("2877")),u=Object(d["a"])(c,o,s,!1,null,null,null);t["a"]=u.exports},"107e":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_property_monitor"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-group",[a("let-form-item",{attrs:{label:e.$t("monitor.search.a")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.thedate,callback:function(t){e.$set(e.query,"thedate",t)},expression:"query.thedate"}})],1),a("let-form-item",{attrs:{label:e.$t("monitor.search.b")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.predate,callback:function(t){e.$set(e.query,"predate",t)},expression:"query.predate"}})],1),a("let-form-item",{attrs:{label:e.$t("monitor.search.start")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.startshowtime,callback:function(t){e.$set(e.query,"startshowtime",t)},expression:"query.startshowtime"}})],1),a("let-form-item",{attrs:{label:e.$t("monitor.search.end")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.endshowtime,callback:function(t){e.$set(e.query,"endshowtime",t)},expression:"query.endshowtime"}})],1)],1),a("let-form-group",[a("tars-form-item",{attrs:{label:e.$t("monitor.search.master")},on:{onLabelClick:function(t){return e.groupBy("master_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_name,callback:function(t){e.$set(e.query,"master_name",t)},expression:"query.master_name"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.search.masterIP")},on:{onLabelClick:function(t){return e.groupBy("master_ip")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_ip,callback:function(t){e.$set(e.query,"master_ip",t)},expression:"query.master_ip"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.select.property")},on:{onLabelClick:function(t){return e.groupBy("property_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.property_name,callback:function(t){e.$set(e.query,"property_name",t)},expression:"query.property_name"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.select.strategy")},on:{onLabelClick:function(t){return e.groupBy("policy")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.policy,callback:function(t){e.$set(e.query,"policy",t)},expression:"query.policy"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1)],1),e.showChart?a("compare-chart",e._b({ref:"chart",staticClass:"chart"},"compare-chart",e.chartOptions,!1)):e._e(),e.enableHourFilter?a("hours-filter",{model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}}):e._e(),a("let-table",{ref:"table",attrs:{data:e.pagedItems,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.show_time||t.row.show_date))]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.master")},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.master_name?a("span",[e._v(e._s(t.row.master_name))]):e._e(),"%"==t.row.master_name?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("master_name",t.row)}}},[e._v(e._s(t.row.master_name))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.masterIP"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.master_ip?a("span",[e._v(e._s(t.row.master_ip))]):e._e(),"%"==t.row.master_ip?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("master_ip",t.row)}}},[e._v(e._s(t.row.master_ip))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.select.property"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.property_name?a("span",[e._v(e._s(t.row.property_name))]):e._e(),"%"==t.row.property_name?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("property_name",t.row)}}},[e._v(e._s(t.row.property_name))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.select.strategy"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.policy?a("span",[e._v(e._s(t.row.policy))]):e._e(),"%"==t.row.policy?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("policy",t.row)}}},[e._v(e._s(t.row.policy))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.property.property"),prop:"the_value",align:"right",width:"200px"}}),a("let-table-column",{attrs:{title:e.$t("monitor.property.propertyC"),prop:"pre_value",align:"right",width:"230px"}}),e.pageCount?a("let-pagination",{attrs:{slot:"pagination",total:e.pageCount,page:e.page,sum:e.itemsCount,"show-sums":"",jump:""},on:{change:e.changePage},slot:"pagination"}):e._e()],1)],1)},s=[],r=(a("99af"),a("4de4"),a("4160"),a("a15b"),a("d81d"),a("fb6a"),a("b64b"),a("ac1f"),a("5319"),a("1276"),a("159b"),a("5530"),a("2699")),n=a("0b18"),i=a("0abb"),l=20,c="YYYYMMDD",d={name:"ServerPropertyMonitor",components:{HoursFilter:n["a"],CompareChart:i["a"]},data:function(){var e=this.$route.params.treeid;return{query:{thedate:Object(r["b"])(new Date,c),predate:Object(r["b"])(Date.now()-r["a"],c),startshowtime:"0000",endshowtime:"2360",master_name:e.split(".").map((function(e){return e.replace(/^\d+/,"")})).join("."),master_ip:"",property_name:"",policy:"",group_by:""},formatter:c,allItems:[],hour:-1,page:1,showChart:!0}},computed:{enableHourFilter:function(){return this.allItems.length&&this.allItems[0].show_time},filteredItems:function(){var e=this.hour;return e>=0&&this.enableHourFilter?this.allItems.filter((function(t){return+t.show_time.slice(0,2)===e})):this.allItems},itemsCount:function(){return this.filteredItems.length},pageCount:function(){return Math.ceil(this.filteredItems.length/l)},pagedItems:function(){return this.filteredItems.slice(l*(this.page-1),l*this.page)},chartOptions:function(){return{title:this.$t("monitor.table.total"),timeColumn:"show_time",dataColumns:[{name:"the_value",label:this.$t("monitor.property.property")},{name:"pre_value",label:this.$t("monitor.property.propertyC")}],data:this.allItems}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t=this.$refs.chart&&this.$refs.chart.$loading.show(),a=this.$refs.table.$loading.show();return this.$ajax.getJSON("/server/api/tarsproperty_monitor_data",this.query).then((function(o){t&&t.hide(),a.hide(),e.allItems=o})).catch((function(o){t&&t.hide(),a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(o.message||o.err_msg))}))},groupBy:function(e,t){this.query.group_by=e,this.showChart=!1,t&&(t.show_time&&(this.query.startshowtime=t.show_time,this.query.endshowtime=t.show_time),t.master_name&&"%"!=t.master_name&&(this.query.master_name=t.master_name),t.master_ip&&"%"!=t.master_ip&&(this.query.master_ip=t.master_ip),t.property_name&&"%"!=t.property_name&&(this.query.property_name=t.property_name),t.policy&&"%"!=t.policy&&(this.query.policy=t.policy)),this.fetchData()},search:function(){delete this.query.group_by,this.showChart=!0,this.fetchData()},changePage:function(e){this.page=e}}},u=d,m=(a("aade"),a("2877")),f=Object(m["a"])(u,o,s,!1,null,null,null);t["a"]=f.exports},1342:function(e,t,a){},"14a7":function(e,t,a){},1817:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsBAMAAADsqkcyAAAAIVBMVEUAAACZsuGasuCbtuRFf/WZseD////q8P3z9vt6o/e2x+iGuTfsAAAABHRSTlMA6aYc+fzKlQAAAGFJREFUKM9jgIBQBEIA+gszK4YiASEDqLBhKAoQhgqrrkhDAl1BUGHRNmThjECYfWkuSCAtFI8w0A50YSDAIUyC2SPOJdMrsZpdlk6MMMIQOoYJZvLBl9gwkybuhDx4choAeHa83egTBYcAAAAASUVORK5CYII="},"1ca6":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAoCAMAAACyy+glAAAA81BMVEUAAACNpf+ky/+ZsuFFgPaasuJoiv9GgPZHgfZGgPWasuJGgPVKgvdMgf9FgPaZsuBGgPWZseFFgPZFgPaas+FHgPdGgfZHgPabs+JIgflGgf+gu+lQh/9FgPWasuBFgPZFgPZFgPWasuFFgPZGgPWas+FGgPaZsuFGgfaas+FGgfZGgPiatOGcteVIgvqduOVFgPWasuGasuGasuFGgPWasuFFgPaZsuJHgfZGgPeZseFGgfeasuKasuNHgfectuKbs+RIgfids+GZseGZsuCZseBFgPaaseFGgPaZseFFgPZGgPZGgPagtOeZs+ZFf/WZseByc+/7AAAAT3RSTlMABAH493gHUTS5k4IcEvvx6d7Wyn99dE5DKRYQDO7p5eDSsqagiGxrZ2ZURjswLxzxycCfmpmJcG9hX1xWST4rJSMh7NDOwLuuqpOPOhkKbHRT8QAAAbxJREFUOMut1Gl3wUAUxvEniQRB0VZROy0tSvd9Qfd17vf/NBUycZmp40V/L3P+52RyMzP4P0Yku9fOO6uk8VhFeHZWaLMlMbG+zR4+uPY3VBmhabsWkeX2F9uwrsUReayz0fx6D6dtKA8uTVOWDeZcTJ1izi5Jd2xmKT/eg8/JFAEUkjJ+NiFFhC8m26i4x9gmSQeQ2jKuGbIVVxgrPKrxpZA+vToxbkUGHttv6wjciMDGZTuWmi3/xx9IssvWrOpgou+WiY7fybqb/RJFqBiMqpszzTOybjFxH1LjHSgj358s4lBt13oslJ9qA/mSUG1BsU+bGFY0bQMaA8SrmjVsmdBJ1NQ5NCLQKm7MLbTTjDWzCeg5L/zlV8tPc5S/Pby0NRu87QCFJfEpa0tfQC7pGn+156xN9YBbi+ior28zrK0OgRZ5yjld22TtepydTVv9ITesrW3DOKFAffE7w2vsbCRg1olJH4CLsA0c9Xb5NXHJBx6zn/zm+PuPe+K7hx0IOdkWcSN2swXthwnpgscDzFTZBaSryw6/uLVnxyapNT+6lBCVMBh+s7mLu7OXNwB9fWJiJbnX9PE1fL8fY9HHKD9QSQAAAABJRU5ErkJggg=="},"25d5":function(e,t,a){"use strict";var o=a("1342"),s=a.n(o);s.a},2699:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return l}));a("4160"),a("b64b"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("1276"),a("159b");var o=1e3,s=60*o,r=60*s,n=24*r;function i(e){return null==e?new Date:e instanceof Date?e:new Date(e)}function l(e,t){if(e=i(e),t=t||"YYYY-MM-DD HH:mm:ss",isNaN(e.getTime()))return t;var a={"M+":e.getMonth()+1,"D+":e.getDate(),"H+":e.getHours(),"h+":e.getHours()%12===0?12:e.getHours()%12,"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};return/(Y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),/(dd+)/.test(t)&&(t=t.replace(RegExp.$1,"日一二三四五六七".split("")[e.getDay()])),Object.keys(a).forEach((function(e){if(new RegExp("("+e+")").test(t)){var o=RegExp.$1,s="".concat(a[e]);t=t.replace(o,1===o.length?s:"00".concat(s).substr(s.length))}})),t}},"29ab":function(e,t,a){"use strict";var o=a("6663"),s=a.n(o);s.a},"2e66":function(e,t,a){"use strict";var o=a("9200"),s=a.n(o);s.a},"33c3":function(e,t,a){"use strict";var o=a("4d7d"),s=a.n(o);s.a},4201:function(e,t,a){"use strict";var o=a("98c9"),s=a.n(o);s.a},"42a1":function(e,t,a){"use strict";a("b0c0");var o=a("5530"),s=a("53ca"),r=a("a026"),n=a("1861"),i=a.n(n),l=(a("8c47"),a("00e7")),c=a.n(l),d=(a("6609"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{staticClass:"icon"},[a("use",{attrs:{"xlink:href":"#"+e.name}})])}),u=[],m={name:"Icon",props:{name:{type:String,required:!0}}},f=m,h=(a("e166"),a("2877")),p=Object(h["a"])(f,d,u,!1,null,null,null),v=p.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("let-form-item",{staticClass:"tars-form-item"},[a("label",{staticClass:"let-form-item__label let-label__position_top clickable",on:{click:function(t){return e.$emit("onLabelClick")}}},[e._v(e._s(e.label))]),e._t("default")],2)},_=[],b={name:"TarsFormItem",props:{label:String}},$=b,M=(a("04b0"),Object(h["a"])($,g,_,!1,null,null,null)),w=M.exports,k=a("0c80"),C=a.n(k),y=a("c400"),x=a.n(y);r["default"].use(i.a,{locale:{en:x.a,cn:C.a}[c.a.get("locale")||"cn"]||C.a}),r["default"].component(v.name,v),r["default"].component(w.name,w);var L=r["default"].prototype.$Loading;function D(e){this.el=e,this.loading=null}D.prototype.show=function(e,t){"object"===Object(s["a"])(e)&&(t=e,e=null),this.loading&&this.hide();var a=this.el,r=L(Object(o["a"])({fullScreen:!a,target:a&&e?a.querySelector(e):a,boxClass:"loading-inner",background:"rgba(0,0,0,0)",color:"#fff",size:24},t));return r.show(),this.loading=r,this},D.prototype.hide=function(){return this.loading&&(this.loading.hide(),this.loading=null),this},D.show=function(){var e;return D._loading||(D._loading=new D),(e=D._loading).show.apply(e,arguments)},D.hide=function(){return D._loading||(D._loading=new D),D._loading.hide()},L.show=D.show,L.hide=D.hide,Object.defineProperty(r["default"].prototype,"$loading",{get:function(){return this._loading||(this._loading=new D(this.$el)),this._loading}}),Object.defineProperty(r["default"].prototype,"$tip",{get:function(){return this.$Notice}})},4824:function(e,t){e.exports="data:image/png;base64,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"},4998:function(e,t,a){},"4d7d":function(e,t,a){},"53f0":function(e,t,a){},"559f":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app_index__footer"})},s=[],r={data:function(){return{thisYear:(new Date).getFullYear()}}},n=r,i=(a("e73b"),a("2877")),l=Object(i["a"])(n,o,s,!1,null,null,null);t["a"]=l.exports},"575d":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_debuger"},[e.showDebug||e.showBm?e._e():a("wrapper",{ref:"tarsFileListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.openTarsUploadFileModal}},[e._v(e._s(e.$t("operate.add")))]),a("let-table",{attrs:{data:e.tarsFileList,title:e.$t("inf.title.listTitle"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"application"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"file_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.showDebuger(t.row)}}},[e._v(e._s(e.$t("inf.list.debug")))]),a("let-table-operation",{on:{click:function(a){return e.showBenchmark(t.row)}}},[e._v(e._s(e.$t("inf.list.benchmark")))]),a("let-table-operation",{on:{click:function(a){return e.deleteTarsFile(t.row.f_id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,2739288495)})],1)],1),e.showDebug?a("div",[a("let-form",{staticClass:"left_align",attrs:{itemWidth:"530px"}},[a("let-form-item",{attrs:{label:e.$t("inf.dlg.selectLabel")}},[a("let-cascader",{attrs:{data:e.contextData,required:"",size:"small"},on:{change:e.getParams}})],1),e.objList.length?a("let-form-item",{attrs:{label:e.$t("inf.dlg.objName")}},[a("let-select",{model:{value:e.objName,callback:function(t){e.objName=t},expression:"objName"}},e._l(e.objList,(function(e){return a("let-option",{key:e.servant,attrs:{value:e.servant}})})),1)],1):e._e(),a("let-form-item",[a("let-button",{attrs:{theme:"primary"},on:{click:e.doDebug}},[e._v(e._s(e.$t("inf.list.debug")))])],1)],1),a("let-row",[a("div",{staticClass:"params_container"},[a("let-col",{attrs:{span:12,itemWidth:"100%"}},[a("let-form",{attrs:{itemWidth:"100%"}},[a("let-input",{staticClass:"param_area div_line",attrs:{type:"textarea",rows:20,placeholder:e.$t("inf.dlg.inParam")},model:{value:e.inParam,callback:function(t){e.inParam=t},expression:"inParam"}})],1)],1),a("let-col",{attrs:{span:12}},[a("let-form",{attrs:{itemWidth:"100%"}},[a("let-input",{staticClass:"param_area",attrs:{type:"textarea",rows:20,placeholder:e.$t("inf.dlg.outParam")},model:{value:e.outParam,callback:function(t){e.outParam=t},expression:"outParam"}})],1)],1)],1)]),a("div",{staticClass:"mt10"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.showDebug=!1}}},[e._v(e._s(e.$t("operate.goback")))])],1)],1):e._e(),e.showBm?a("InterfaceBenchmark",{ref:"bm",attrs:{servantList:e.objList}}):e._e(),a("let-modal",{attrs:{title:e.$t("inf.title.dlgTitle"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadTarsFile(t)}}},[a("let-form-item",{attrs:{itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.filetype"),accept:".tars",multiple:""},on:{upload:e.uploadFile}},[e._v(e._s(e.$t("common.submit")))]),e._l(e.uploadModal.fileList2Show,(function(t){return a("li",{key:t.index},[e._v(e._s(t.name))])}))],2),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1),a("let-modal",{attrs:{title:e.$t("inf.benchmark.installBenchmark"),width:"400px",headShow:!1},model:{value:e.showInstallBm,callback:function(t){e.showInstallBm=t},expression:"showInstallBm"}},[a("div",[a("p",[e._v(e._s(e.$t("inf.benchmark.installTip")))]),a("p",[e._v(e._s(e.$t("inf.benchmark.installTutorial"))+"："),a("a",{attrs:{href:"https://github.com/TarsCloud/TarsBenchmark/blob/master/README.zh.md#QuickStart",target:"_blank"}},[e._v(e._s(e.$t("inf.benchmark.installScript")))])])])])],1)},s=[],r=(a("99af"),a("4160"),a("a630"),a("b0c0"),a("ac1f"),a("3ca3"),a("1276"),a("159b"),a("53ca")),n=a("b85c"),i=a("dcab"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"benchmark_wrapper"},[a("let-form",{staticClass:"left_align",attrs:{itemWidth:"350px"}},[a("let-form-item",{attrs:{label:e.$t("inf.dlg.objName")}},[a("let-select",{attrs:{size:"small"},on:{change:e.objChange},model:{value:e.servant,callback:function(t){e.servant=t},expression:"servant"}},e._l(e.servantList,(function(e){return a("let-option",{key:e.servant,attrs:{value:e.servant}})})),1)],1)],1),a("let-table",{attrs:{data:e.fnList,title:e.$t("inf.benchmark.fnlist"),"empty-msg":e.$t("inf.benchmark.nofn"),"row-class-name":e.fnRowClassName}},[a("let-table-column",{attrs:{title:e.$t("inf.benchmark.interface"),prop:"interface",width:"100px"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.fnname"),prop:"name",width:"120px"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.returnType"),prop:"return",width:"120px"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.inParam")},scopedSlots:e._u([{key:"default",fn:function(e){return[a("json-view",{attrs:{maxDepth:0,rootKey:"view",colorScheme:"dark",data:JSON.parse(e.row.inParams)}})]}}])}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.outParam")},scopedSlots:e._u([{key:"default",fn:function(e){return[a("json-view",{attrs:{maxDepth:0,rootKey:"view",colorScheme:"dark",data:JSON.parse(e.row.outParams)}})]}}])}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.queryCase(t.row)}}},[e._v(e._s(e.$t("inf.benchmark.case")))])]}}])})],1),e.showCase?a("wrapper",[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.initCaseContentForm}},[e._v(e._s(e.$t("inf.benchmark.addCase")))]),a("let-table",{attrs:{data:e.bmCaseList,title:e.currentFn.interface+"."+e.currentFn.name+" "+e.$t("inf.benchmark.caselist"),"empty-msg":e.$t("inf.benchmark.nocase")}},[a("let-table-column",{attrs:{title:e.$t("inf.benchmark.des"),prop:"des"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.inputValue"),prop:"in_values"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.initCaseContentForm(t.row)}}},[e._v(e._s(e.$t("inf.benchmark.modifyCase")))]),a("let-table-operation",{on:{click:function(a){return e.initCaseConfigForm(t.row,"test")}}},[e._v(e._s(e.$t("inf.benchmark.testCase")))]),a("let-table-operation",{on:{click:function(a){return e.initCaseConfigForm(t.row,"start")}}},[e._v(e._s(e.$t("inf.benchmark.runCase")))]),a("let-table-operation",{on:{click:function(a){return e.queryResult(t.row)}}},[e._v(e._s(e.$t("inf.benchmark.viewResult")))]),a("let-table-operation",{on:{click:function(a){return e.deleteBmCase(t.row)}}},[e._v(e._s(e.$t("inf.benchmark.deleteCase")))])]}}],null,!1,2362952868)})],1)],1):e._e(),a("div",{staticClass:"mt10"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.$parent.showBm=!1}}},[e._v(e._s(e.$t("operate.goback")))])],1),a("let-modal",{attrs:{title:e.$t("inf.benchmark.case"),width:"700px"},on:{"on-confirm":e.upsertCaseContent},model:{value:e.upsertCaseContentModal,callback:function(t){e.upsertCaseContentModal=t},expression:"upsertCaseContentModal"}},[a("let-form",{attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("inf.benchmark.des")}},[a("let-input",{attrs:{size:"small"},model:{value:e.caseModel.des,callback:function(t){e.$set(e.caseModel,"des",t)},expression:"caseModel.des"}})],1),a("let-form-item",{attrs:{label:e.$t("inf.benchmark.inParam")}},[a("json-view",{attrs:{maxDepth:0,rootKey:"view",data:JSON.parse(e.currentFn.inParams||"{}")}})],1),a("let-form-item",{attrs:{label:e.$t("inf.benchmark.inputValue")}},[a("let-input",{attrs:{size:"small",rows:10,type:"textarea"},model:{value:e.caseModel.in_values,callback:function(t){e.$set(e.caseModel,"in_values",t)},expression:"caseModel.in_values"}}),a("a",{attrs:{target:"_blank",href:"https://github.com/TarsCloud/TarsDocs/blob/master/benchmark/tars-guide.md"}},[a("let-table-operation",[e._v(e._s(e.$t("inf.benchmark.inputValueDes")))])],1)],1)],1)],1),a("let-modal",{ref:"startBm",attrs:{footShow:!1,title:e.$t("inf.benchmark.bmParams"),width:"700px"},model:{value:e.upsertCaseConfigModal,callback:function(t){e.upsertCaseConfigModal=t},expression:"upsertCaseConfigModal"}},[a("let-form",{staticClass:"start-bm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:"servant"}},[a("let-input",{attrs:{disabled:"",size:"small"},model:{value:e.caseModel.servant,callback:function(t){e.$set(e.caseModel,"servant",t)},expression:"caseModel.servant"}})],1),a("let-form-item",{attrs:{label:e.$t("inf.benchmark.endpoints")}},[e._l(e.endpoints,(function(t,o){return a("let-checkbox",{key:o,staticClass:"checkbox_endpoint_item",model:{value:e.endpoints[o],callback:function(t){e.$set(e.endpoints,o,t)},expression:"endpoints[name]"}},[e._v(e._s(o))])})),a("let-input",{attrs:{size:"small",type:"textarea",placeholder:e.$t("inf.benchmark.endpointsTip")},model:{value:e.caseModel.endpoints,callback:function(t){e.$set(e.caseModel,"endpoints",t)},expression:"caseModel.endpoints"}})],2),a("let-form-group",{attrs:{inline:"","label-position":"top"}},["start"==e.upsertCaseConfigModal?a("let-form-item",{attrs:{label:e.$t("inf.benchmark.links"),size:5}},[a("let-input",{attrs:{type:"number",size:"small",required:""},model:{value:e.caseModel.links,callback:function(t){e.$set(e.caseModel,"links",t)},expression:"caseModel.links"}})],1):e._e(),"start"==e.upsertCaseConfigModal?a("let-form-item",{attrs:{label:e.$t("inf.benchmark.speed"),size:5}},[a("let-input",{attrs:{type:"number",size:"small",required:""},model:{value:e.caseModel.speed,callback:function(t){e.$set(e.caseModel,"speed",t)},expression:"caseModel.speed"}})],1):e._e(),"start"==e.upsertCaseConfigModal?a("let-form-item",{attrs:{label:e.$t("inf.benchmark.duration"),size:5}},[a("let-input",{attrs:{type:"number",size:"small",required:""},model:{value:e.caseModel.duration,callback:function(t){e.$set(e.caseModel,"duration",t)},expression:"caseModel.duration"}})],1):e._e(),e.testResultModal?a("let-form-item",{attrs:{label:e.$t("inf.benchmark.testResult"),size:5}},[a("div",[e._v(" "+e._s(e.testResult.errmsg||e.testResultRsp)+" ")])]):e._e(),a("let-form-item",{attrs:{size:5}},["test"==e.upsertCaseConfigModal?a("let-button",{staticClass:"start_bm",attrs:{theme:"primary"},on:{click:function(t){return e.execBenchmark("test")}}},[e._v(e._s(e.$t("inf.benchmark.infTest")))]):e._e(),"start"==e.upsertCaseConfigModal?a("let-button",{staticClass:"start_bm",attrs:{theme:"primary"},on:{click:e.upsertCaseConfig}},[e._v(e._s(e.$t("inf.benchmark.startBenchmark")))]):e._e(),a("let-button",{staticClass:"cancel_bm",on:{click:function(t){e.upsertCaseConfigModal=!1}}},[e._v(e._s(e.$t("inf.benchmark.cancelTest")))])],1)],1)],1)],1),a("let-modal",{attrs:{footShow:!1,title:e.result.fn+" - "+e.$t("inf.benchmark.testResult"),width:"1300px"},model:{value:e.resultModal,callback:function(t){e.resultModal=t},expression:"resultModal"}},[a("wrapper",[a("div",{staticClass:"result_op"},[0==e.result.status?a("let-button",{staticClass:"bmop-btn",attrs:{size:"small",theme:"success"},on:{click:function(t){return e.initCaseConfigForm(e.currentCase,"start")}}},[e._v(e._s(e.$t("inf.benchmark.startBenchmark")))]):e._e(),1==e.result.status?a("let-button",{staticClass:"bmop-btn",attrs:{size:"small",theme:"danger"},on:{click:function(t){return e.execBenchmark("stop")}}},[e._v(e._s(e.$t("inf.benchmark.stopBenchmark")))]):e._e(),a("let-button",{staticClass:"bmop-btn",attrs:{size:"small",theme:"sub-primary"},on:{click:function(t){return e.getResultById(e.result.id)}}},[e._v(e._s(e.$t("inf.benchmark.refresh"))),1==e.result.status?a("span",[e._v("("+e._s(e.nextRefresh)+"s)")]):e._e()])],1),a("div",{staticClass:"result_select"},[a("let-radio",{attrs:{label:"detail"},model:{value:e.resultMode,callback:function(t){e.resultMode=t},expression:"resultMode"}},[e._v(e._s(e.$t("inf.benchmark.detail")))]),a("let-radio",{attrs:{label:"chart"},model:{value:e.resultMode,callback:function(t){e.resultMode=t},expression:"resultMode"}},[e._v(e._s(e.$t("inf.benchmark.stat")))])],1),"detail"==e.resultMode?a("let-table",{staticStyle:{height:"500px",overflow:"auto"},attrs:{data:e.result.results,"empty-msg":"data is empty"}},[a("let-table-column",{attrs:{title:e.$t("inf.benchmark.time"),prop:"time_stamp",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(e.formatDate(1e3*o.time_stamp)))])]}}],null,!1,765786504)}),a("let-table-column",{attrs:{title:"qps",prop:"avg_speed",width:"70px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.total"),prop:"total_request",width:"70px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.success"),prop:"succ_request",width:"70px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.fail"),prop:"fail_request",width:"70px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.successRate"),width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(e.getSuccessRate(o)))])]}}],null,!1,1802954844)}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.maxCost"),prop:"max_time",width:"80px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.minCost"),prop:"min_time",width:"80px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.avgCost"),width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(0==o.total_request?0:(o.total_time/o.total_request).toFixed(2)))])]}}],null,!1,882222135)}),a("let-table-column",{attrs:{title:"p90",width:"70px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.p90_time.toFixed(2)))])]}}],null,!1,1999143014)}),a("let-table-column",{attrs:{title:"p99",width:"70px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.p99_time.toFixed(2)))])]}}],null,!1,1672509679)}),a("let-table-column",{attrs:{title:"p999",width:"70px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("span",[e._v(e._s(o.p999_time.toFixed(2)))])]}}],null,!1,1192471318)}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.sendBytes"),prop:"send_bytes",width:"80px",align:"center"}}),a("let-table-column",{attrs:{title:e.$t("inf.benchmark.recvBytes"),prop:"recv_bytes",width:"80px",align:"center"}})],1):e._e(),"chart"==e.resultMode?a("div",{staticClass:"return_chart"},[a("ve-pie",{attrs:{legend:e.returnChartOptions.legend,title:e.returnChartOptions.title,data:e.returnChartOptions,width:"500px"}}),a("ve-pie",{attrs:{legend:e.costChartOptions.legend,title:e.costChartOptions.title,data:e.costChartOptions,width:"500px"}})],1):e._e()],1)],1)],1)},c=[],d=(a("4de4"),a("c975"),a("a15b"),a("d81d"),a("a434"),a("b680"),a("b64b"),a("d3b7"),a("6062"),a("5319"),a("ddb0"),a("ade3")),u=a("10be"),m=a.n(u),f=a("3057"),h=a("2699"),p={id:-1,des:"",in_values:""},v=5e3,g={name:"InterfaceBenchmark",components:{wrapper:i["a"],VePie:m.a,"json-view":f["a"]},data:function(){return{showCase:!1,upsertCaseContentModal:!1,upsertCaseConfigModal:!1,resultModal:!1,testResultModal:!1,servant:"",currentFn:{},currentCase:{},resultMode:"detail",endpoints:{},selectedEndpoints:[],fnList:[],bmCaseList:[],result:{results:[],status:0},testResult:{},nextRefresh:6,nextRefreshTimer:0,caseModel:Object.assign({},p)}},methods:{formatDate:h["b"],fnRowClassName:function(e){var t=e.row;e.rowIndex;return t==this.currentFn?"current_fn":""},getSuccessRate:function(e){var t=e.succ_request+e.fail_request;return t?(100*e.succ_request/t).toFixed(2)+"%":"0%"},upsertBmCase:function(e){var t=this,a=this.$Loading.show();e.servant=this.servant,e.fn=this.currentFn.name,this.$ajax.postJSON("/server/api/upsert_bm_case",e).then((function(e){a.hide(),t.getBenchmarkCaseList(),t.upsertCaseContentModal=!1,t.upsertCaseConfigModal=!1})).catch((function(e){a.hide(),t.upsertCaseContentModal=!1,t.upsertCaseConfigModal=!1,t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},initCaseContentForm:function(e){e&&e.id?this.caseModel=Object.assign({},e):(this.caseModel=Object.assign({},p),this.caseModel.in_values=this.currentFn.funInput),this.upsertCaseContentModal=!0},initCaseConfigForm:function(e,t){if(e){this.currentCase=e,this.testResult={},this.testResultModal=!1,this.caseModel=Object.assign({},e),this.caseModel.links||(this.caseModel.links=1),this.caseModel.speed||(this.caseModel.speed=1),this.caseModel.duration||(this.caseModel.duration=20);var a=this.caseModel.endpoints.split("\n");for(var o in this.endpoints){var s=a.indexOf(o);s>-1?(this.endpoints[o]=!0,a.splice(s,1)):this.endpoints[o]=!1}this.caseModel.endpoints=a.join("\n"),this.upsertCaseConfigModal=t,this.resultModal=!1}},upsertCaseContent:function(){var e={};this.caseModel.id>0&&(e.id=this.caseModel.id),e.des=this.caseModel.des,e.in_values=this.caseModel.in_values,this.upsertBmCase(e)},upsertCaseConfig:function(){var e={};e.id=this.caseModel.id,e.links=this.caseModel.links,e.speed=this.caseModel.speed,e.duration=this.caseModel.duration,e.endpoints=this.queryFullEndpoints(),this.upsertBmCase(e),e.endpoints&&this.caseModel.links&&this.caseModel.speed&&this.caseModel.duration?this.execBenchmark():this.$Notice({title:"missing params",type:"error"})},execBenchmark:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"start",a={caseId:this.currentCase.id,servant:this.servant,fn:this.currentFn.name},o="";switch(t){case"start":o="/server/api/start_bencmark",a.para_input=this.currentFn.inParams,a.para_value=this.currentCase.in_values,a.para_output=this.currentFn.outParams,a.endpoints=this.queryFullEndpoints(),a.links=this.caseModel.links,a.speed=this.caseModel.speed,a.duration=this.caseModel.duration;break;case"stop":o="/server/api/stop_bencmark";break;case"test":o="/server/api/test_bencmark",a.para_input=this.currentFn.inParams,a.para_value=this.currentCase.in_values,a.para_output=this.currentFn.outParams,a.endpoints=this.queryFullEndpoints();break}this.$ajax.postJSON(o,a).then((function(a){switch("start"==t&&e.queryResult(),t){case"start":e.result.status=e.currentCase.status=1,e.queryResult();break;case"stop":e.result.status=e.currentCase.status=0,e.stopPollingResult();break;case"test":e.testResult=a,e.testResultModal=!0;break}})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},queryFullEndpoints:function(){var e=[];for(var t in this.endpoints)console.log("endpoint:",t," checked:",this.endpoints[t]),this.endpoints[t]&&e.push(t);return this.caseModel.endpoints.split("\n").forEach((function(t){e.push(t)})),Array.from(new Set(e)).filter((function(e){return!!e})).join("\n")},queryResult:function(e){e&&(this.currentCase=e),this.getResultById(this.currentCase.id),this.resultModal=!0},queryCase:function(e){this.showCase=!0,this.currentFn=e,this.getBenchmarkCaseList()},getBenchmarkDes:function(e){var t=this;this.$ajax.getJSON("/server/api/get_benchmark_des",{id:e}).then((function(e){t.fnList=e})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},getBenchmarkCaseList:function(){var e=this;this.$ajax.getJSON("/server/api/get_bm_case_list",{servant:this.servant,fn:this.currentFn.name}).then((function(t){e.bmCaseList=t})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getResultById:function(e){var t=this;this.result.id=e,this.$ajax.getJSON("/server/api/get_bm_result_by_id",{id:e}).then((function(e){e.results=JSON.parse(e.results||"[]"),e.results.reverse(),t.result=e})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},deleteBmCase:function(e){var t=this;this.$confirm(this.$t("inf.benchmark.deleteCaseConfirm"),this.$t("common.alert")).then((function(){t.$Loading.show();var a={};a.id=e.id,a.is_deleted=1,t.upsertBmCase(a)}))},startPollingResult:function(){var e=this;this.stopPollingResult(),this.nextRefreshTimer=setInterval((function(){e.nextRefresh--,0==e.nextRefresh?e.queryResult():e.nextRefresh<0&&e.nextRefresh<0&&(e.nextRefresh=v/1e3)}),1e3)},stopPollingResult:function(){this.nextRefresh=v/1e3,clearInterval(this.nextRefreshTimer)},objChange:function(){var e=this;this.servant&&this.$ajax.getJSON("/server/api/get_endpoints",{servant:this.servant}).then((function(t){e.endpoints={},t.forEach((function(t){e.endpoints["".concat(t.istcp?"tcp":"udp"," -h ").concat(t.host," -p ").concat(t.port," -t ").concat(t.timeout)]=!1}))})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},pieFromResult:function(e,t,a,o){var s,r={},i=Object(n["a"])(this.result.results);try{for(i.s();!(s=i.n()).done;){var l=s.value;if(l[o])for(var c in l[o])r[c]||(r[c]=0),r[c]+=l[o][c]}}catch(m){i.e(m)}finally{i.f()}var u=Object.keys(r).map((function(e){var o;return o={},Object(d["a"])(o,t,e),Object(d["a"])(o,a,r[e]),o}));return{title:{text:e||""},legend:{orient:"vertical",top:50,right:0},columns:[t,a],rows:u}}},computed:{testResultRsp:function(){return(this.testResult.rsp||"").replace(/<br>/g,"\n")},costChartOptions:function(){return this.pieFromResult(this.$t("inf.benchmark.costStat"),"返回值","数量","cost_map")},returnChartOptions:function(){return this.pieFromResult(this.$t("inf.benchmark.retStat"),"返回值","数量","ret_map")}},props:{servantList:{type:Array,required:!0}},watch:{servantList:{immediate:!0,handler:function(e,t){e.length&&!this.servant&&(this.servant=e[0].servant,this.objChange())}},resultModal:function(e,t){if(e){if(0==this.currentCase.status)return;this.startPollingResult()}else this.stopPollingResult()}},beforeDestory:function(){this.stopPollingResult()}},_=g,b=(a("8324"),a("2877")),$=Object(b["a"])(_,l,c,!1,null,null,null),M=$.exports,w={name:"InterfaceDebuger",components:{wrapper:i["a"],InterfaceBenchmark:M},data:function(){return{serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},tarsFileList:[],uploadModal:{show:!1,model:{},fileList2Show:[]},showDebug:!1,showBm:!1,showInstallBm:!1,isBmInstalled:null,contextData:[],debuger_panel:!1,inParam:"",outParam:"",selectedFileName:"",selectedMethods:[],objName:"",objList:[],selectedId:""}},methods:{getFileList:function(){var e=this,t=this.$Loading.show();this.$ajax.getJSON("/server/api/get_file_list",{application:this.serverData.application,server_name:this.serverData.server_name}).then((function(a){t.hide(),e.tarsFileList=a})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},getBmInstalled:function(){var e=this;this.$ajax.getJSON("/server/api/is_benchmark_installed").then((function(t){e.isBmInstalled=t})).catch((function(t){console.error("get bm installed status error",t),e.$tip.error("error:".concat(t.err_msg||t.message)),e.isBmInstalled=!1}))},openTarsUploadFileModal:function(){this.uploadModal.show=!0,this.uploadModal.model={application:this.serverData.application,server_name:this.serverData.server_name,set_name:this.serverData.set_name,file:[]},this.uploadModal.fileList2Show=[]},uploadFile:function(e){if(this.uploadModal.fileList2Show=[],e.length){var t,a=0,o=Object(n["a"])(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;this.uploadModal.fileList2Show.push({name:s.name,index:100*Math.random()});var r=s.name.split("."),i=r[r.length-1];if("tars"!==i)break;a+=1}}catch(l){o.e(l)}finally{o.f()}a===e.length&&(this.uploadModal.model.file=Array.from(e))}},uploadTarsFile:function(){var e=this;if(this.$refs.uploadForm.validate()){var t=this.$Loading.show(),a=new FormData;a.append("application",this.uploadModal.model.application),a.append("server_name",this.uploadModal.model.server_name),a.append("set_name",this.uploadModal.model.set_name),this.uploadModal.model.file.forEach((function(e){return a.append("suse",e)})),this.$ajax.postForm("/server/api/upload_tars_file",a).then((function(){t.hide(),e.getFileList(),e.uploadModal.show=!1,e.uploadModal.model=null})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))}},closeUploadModal:function(){this.uploadModal.show=!1},showDebuger:function(e){this.showDebug=!0,this.selectedFileName=e.file_name,this.inParam=null,this.outParam=null,this.selectedId=e.f_id,this.objName=null,this.getContextData(e.f_id),this.getObjList()},showBenchmark:function(e){var t=this;null!==this.isBmInstalled&&(this.isBmInstalled?(this.showBm=!0,this.showDebug=!1,this.$nextTick((function(){t.$refs.bm.getBenchmarkDes(e.f_id)}))):this.showInstallBm=!0)},deleteTarsFile:function(e){var t=this;this.$confirm(this.$t("inf.dlg.deleteMsg"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_tars_file",{id:e}).then((function(e){a.hide(),t.getFileList()})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},getObjList:function(){var e=this;this.$ajax.getJSON("/server/api/all_adapter_conf_list",{application:this.serverData.application,server_name:this.serverData.server_name}).then((function(t){t.length&&(e.objList=t,e.objName=t[0].servant)})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getContextData:function(e){var t=this;this.$ajax.getJSON("/server/api/get_contexts",{id:e,application:this.serverData.application,server_name:this.serverData.server_name,type:"all"}).then((function(e){t.contextData=e})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},parseFields:function(e){var t={};for(var a in e){var o=e[a].defaultValue;o||("string"===e[a].type?o="":"long"!==e[a].type&&"int"!==e[a].type||(o=0)),t[a]=o}return t},getParams:function(e){var t=this;if(this.selectedMethods=e,3==e.length){var a=this.$Loading.show();this.$ajax.getJSON("/server/api/get_params",{application:this.serverData.application,server_name:this.serverData.server_name,id:this.selectedId,module_name:e[0],interface_name:e[1],function_name:e[2]}).then((function(o){a.hide();var s={};t.$ajax.getJSON("/server/api/get_structs",{id:t.selectedId,module_name:e[0]}).then((function(e){o.forEach((function(a){if(!a.out)if("string"===a.type)s[a.name]="";else if("array"===a.type)s[a.name]=[];else if("object"===Object(r["a"])(a.type))if(a.type.vector)s[a.name]=[];else if(a.type.isEnum){s[a.name]={}}else a.type.isStruct&&(s[a.name]=t.parseFields(e.structs[a.type.name].fields));else s[a.name]=""})),t.inParam=JSON.stringify(s,null,4)}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))}},doDebug:function(){var e=this,t=this.$Loading.show();this.$ajax.postJSON("/server/api/interface_test",{id:this.selectedId,application:this.serverData.application,server_name:this.serverData.server_name,file_name:this.selectedFileName,module_name:this.selectedMethods[0],interface_name:this.selectedMethods[1],function_name:this.selectedMethods[2],params:this.inParam,objName:this.objName}).then((function(a){t.hide(),e.outParam=a})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))}},created:function(){this.serverData=this.$parent.getServerData(),this.getObjList()},mounted:function(){this.getFileList(),this.getBmInstalled()}},k=w,C=(a("aa73"),Object(b["a"])(k,o,s,!1,null,"713c54f3",null));t["a"]=C.exports},"57b6":function(e,t,a){},6609:function(e,t,a){},6663:function(e,t,a){},6744:function(e,t,a){"use strict";var o=a("bf5c"),s=a.n(o);s.a},"70a0":function(e,t,a){},"7ad2":function(e,t,a){"use strict";a("99af"),a("4160"),a("c975"),a("a15b"),a("13d5"),a("fb6a"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("1276"),a("159b");var o=a("d4ec"),s=a("bee2"),r=a("53ca"),n=function(e){return"string"===typeof e},i=Array.isArray,l=function(e){return"object"===Object(r["a"])(e)&&null!==e},c=function(e){return"function"===typeof e},d=Object.assign;function u(e){return String(e).replace(/(?:[\0- "-&\+-\}\x7F-\xA8\xAA-\xAD\xAF-\u2121\u2123-\u23E8\u23F0-\u23F2\u23F4-\u23F7\u23FB-\u24C1\u24C3-\u25B5\u25B7-\u25FF\u27C0-\u2933\u2936-\u2B04\u2B08-\u2B1A\u2B1D-\u2B4F\u2B51-\u2B54\u2B56-\u302F\u3031-\u303C\u303E-\u3296\u3298\u329A-\uD7FF\uE000-\uFFFF]|[\uD800-\uD83B\uD83F-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDC03\uDC05-\uDCCE\uDCD0-\uDD6F\uDD72-\uDD7D\uDD80-\uDD8D\uDD8F\uDD90\uDE52-\uDEFF]|\uD83D[\uDE50-\uDE7F\uDF00-\uDFFF]|\uD83E[\uDC00-\uDCFF\uDE00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,encodeURIComponent).replace(/ /g,"+").replace(/[!'()~*]/g,(function(e){return"%".concat(e.charCodeAt().toString(16).slice(-2).toUpperCase())}))}function m(e){if(!e)return"";var t=[];return Object.keys(e).forEach((function(a){var o=e[a];null!==o&&void 0!==o||(o=""),t.push("".concat(u(a),"=").concat(u(o)))})),t.join("&").replace(/%20/g,"+")}function f(e){var t=function e(t,a,o){return i(o)||l(o)?(Object.keys(o).forEach((function(s){e(t,"".concat(a,"[").concat(s,"]"),o[s])})),t):(t[a]=o,t)};return m(Object.keys(e).reduce((function(a,o){return t(a,o,e[o])}),{}))}var h=function(){function e(t){Object(o["a"])(this,e),this.defaults=t}return Object(s["a"])(e,[{key:"get",value:function(e){return d({},this.defaults,e)}},{key:"set",value:function(e,t){var a=this;if(e){if(n(e)){var o=e.split(".");o.reduce((function(e,a,s){return s===o.length-1&&(e[a]=t),e[a]}),this.defaults)}l(e)&&Object.keys(e).forEach((function(t){a.set(t,e[t])})),i(e)&&e.forEach((function(e){return a.set(e,t)}))}}},{key:"remove",value:function(e){var t=this;if(e){if(n(e)){var a=e.split(".");a.reduce((function(e,t,o){return o===a.length-1&&delete e[t],e[t]}),this.defaults)}i(e)&&e.forEach((function(e){return t.remove(e)}))}}}]),e}(),p=function(){function e(t){Object(o["a"])(this,e),this.handler=t}return Object(s["a"])(e,[{key:"set",value:function(e){c(e)&&(this.handler=e)}},{key:"exec",value:function(){c(this.handler)&&this.handler.apply(null,arguments)}}]),e}(),v=function(){function e(t){Object(o["a"])(this,e),this.base=t||""}return Object(s["a"])(e,[{key:"set",value:function(e){n(e)&&(this.base=e)}},{key:"get",value:function(e){return this.base+(e||"")}}]),e}(),g=new v,_=new h({credentials:"same-origin",timeout:5e3}),b=new h({"X-Requested-With":"XMLHttpRequest"}),$=new h({}),M=new p,w=new p((function(){return!0}));function k(e,t){var a=m($.get(t));return a&&(a=-1===e.indexOf("?")?"?".concat(a):"&".concat(a)),e+a}function C(e){var t=e.status;if(t>=200&&t<300||304===t)return e;throw M.exec(t,e),new Error(e.statusText)}function y(e){return e.json().then(null,(function(t){return M.exec(500,e),Promise.reject(t)}))}function x(e){return w.handler(e)?e:Promise.reject(e)}function L(e){return Promise.reject(e)}function D(e,t){var a=_.get({headers:b.get()});return fetch(g.get(k(e,t)),a).then(C).then(y).catch(L)}function F(e,t){var a=_.get({headers:b.get()});return fetch(g.get(k(e,t)),a).then(C).then(y).then(x).catch(L)}function S(e,t){var a=_.get({method:"POST",headers:b.get({"Content-Type":"application/x-www-form-urlencoded"}),body:f($.get(t))});return fetch(g.get(e),a).then(C).then(y).then(x).catch(L)}function O(e,t){var a=_.get({method:"POST",headers:b.get(),body:t}),o=$.get({});return Object.keys(o).forEach((function(e){t.append(e,o[e])})),fetch(g.get(e),a).then(C).then(y).then(x).catch(L)}function j(e,t){var a=_.get({method:"POST",headers:b.get({Accept:"application/json","Content-Type":"application/json"}),body:JSON.stringify($.get(t))});return fetch(g.get(e),a).then(C).then(y).then(x).catch(L)}function N(e,t){var a=_.get({method:"PUT",headers:b.get({"Content-Type":"application/x-www-form-urlencoded"}),body:f($.get(t))});return fetch(g.get(e),a).then(C).then(y).then(x).catch(L)}function R(e,t){var a=_.get({method:"DELETE",headers:b.get()});return fetch(g.get(k(e,t)),a).then(C).then(y).then(x).catch(L)}function q(e,t){window.open(g.get(k(e,t)))}t["a"]={ServerUrl:g,Options:_,Headers:b,Body:$,StatusHandler:M,ResultHandler:w,get:D,getJSON:F,post:S,postForm:O,postJSON:j,put:N,remove:R,download:q}},8324:function(e,t,a){"use strict";var o=a("53f0"),s=a.n(o);s.a},"8b32":function(e,t,a){},"8d5c":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_server_monitor"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("monitor.search.a")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.thedate,callback:function(t){e.$set(e.query,"thedate",t)},expression:"query.thedate"}})],1),a("let-form-item",{attrs:{label:e.$t("monitor.search.b")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.predate,callback:function(t){e.$set(e.query,"predate",t)},expression:"query.predate"}})],1),a("let-form-item",{attrs:{label:e.$t("monitor.search.start")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.startshowtime,callback:function(t){e.$set(e.query,"startshowtime",t)},expression:"query.startshowtime"}})],1),a("let-form-item",{attrs:{label:e.$t("monitor.search.end")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.endshowtime,callback:function(t){e.$set(e.query,"endshowtime",t)},expression:"query.endshowtime"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.search.interfaceName")},on:{onLabelClick:function(t){return e.groupBy("interface_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.interface_name,callback:function(t){e.$set(e.query,"interface_name",t)},expression:"query.interface_name"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.search.master")},on:{onLabelClick:function(t){return e.groupBy("master_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_name,callback:function(t){e.$set(e.query,"master_name",t)},expression:"query.master_name"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.search.slave")},on:{onLabelClick:function(t){return e.groupBy("slave_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.slave_name,callback:function(t){e.$set(e.query,"slave_name",t)},expression:"query.slave_name"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.search.masterIP")},on:{onLabelClick:function(t){return e.groupBy("master_ip")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_ip,callback:function(t){e.$set(e.query,"master_ip",t)},expression:"query.master_ip"}})],1),a("tars-form-item",{attrs:{label:e.$t("monitor.search.slaveIP")},on:{onLabelClick:function(t){return e.groupBy("slave_ip")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.slave_ip,callback:function(t){e.$set(e.query,"slave_ip",t)},expression:"query.slave_ip"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1),e.showChart?a("let-row",{ref:"charts",staticClass:"charts"},e._l(e.charts,(function(t){return a("let-col",{key:t.title,attrs:{span:12}},[e.allItems.length>0?a("compare-chart",e._b({},"compare-chart",t,!1)):e._e()],1)})),1):e._e(),e.enableHourFilter?a("hours-filter",{model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}}):e._e(),a("let-table",{ref:"table",attrs:{data:e.pagedItems,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.show_time||t.row.show_date))]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.master")},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.master_name?a("span",[e._v(e._s(t.row.master_name))]):e._e(),"%"==t.row.master_name?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("master_name",t.row)}}},[e._v(e._s(t.row.master_name))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.slave")},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.slave_name?a("span",[e._v(e._s(t.row.slave_name))]):e._e(),"%"==t.row.slave_name?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("slave_name",t.row)}}},[e._v(e._s(t.row.slave_name))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.interfaceName")},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.interface_name?a("span",[e._v(e._s(t.row.interface_name))]):e._e(),"%"==t.row.interface_name?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("interface_name",t.row)}}},[e._v(e._s(t.row.interface_name))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.masterIP")},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.master_ip?a("span",[e._v(e._s(t.row.master_ip))]):e._e(),"%"==t.row.master_ip?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("master_ip",t.row)}}},[e._v(e._s(t.row.master_ip))]):e._e()]}}])}),a("let-table-column",{attrs:{title:e.$t("monitor.search.slaveIP")},scopedSlots:e._u([{key:"default",fn:function(t){return["%"!=t.row.slave_ip?a("span",[e._v(e._s(t.row.slave_ip))]):e._e(),"%"==t.row.slave_ip?a("span",{staticClass:"btn-link",on:{click:function(a){return e.groupBy("slave_ip",t.row)}}},[e._v(e._s(t.row.slave_ip))]):e._e()]}}])}),a("let-table-column",{attrs:{prop:"the_total_count",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.total")))])}}])}),a("let-table-column",{attrs:{prop:"pre_total_count",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.total")))])}}])}),a("let-table-column",{attrs:{prop:"total_count_wave",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.fluctuating")))])}}])}),a("let-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.a")))])}},{key:"default",fn:function(t){return[e._v(e._s(t.row.the_avg_time)+"ms")]}}])}),a("let-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.a")))])}},{key:"default",fn:function(t){return[e._v(e._s(t.row.pre_avg_time)+"ms")]}}])}),a("let-table-column",{attrs:{prop:"the_fail_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.b")))])}}])}),a("let-table-column",{attrs:{prop:"pre_fail_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.b")))])}}])}),a("let-table-column",{attrs:{prop:"the_timeout_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.c")))])}}])}),a("let-table-column",{attrs:{prop:"pre_timeout_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.c")))])}}])}),e.pageCount?a("let-pagination",{attrs:{slot:"pagination",total:e.pageCount,page:e.page,sum:e.itemsCount,"show-sums":"",jump:""},on:{change:e.changePage},slot:"pagination"}):e._e()],1)],1)},s=[],r=(a("99af"),a("4de4"),a("4160"),a("a15b"),a("d81d"),a("fb6a"),a("b64b"),a("ac1f"),a("5319"),a("1276"),a("159b"),a("5530")),n=a("2699"),i=a("0b18"),l=a("0abb"),c=20,d="YYYYMMDD",u=function(e){return e&&e.length>0?e.map((function(e){var t=Object(r["a"])({},e),a=Object.keys(e),o=/^pre_.*/,s=/^the_.*/;return a.forEach((function(a){(o.test(a)||s.test(a))&&"0.00%"===e[a]&&(t[a]="0")})),t})):e},m={name:"ServerPropertyMonitor",components:{HoursFilter:i["a"],CompareChart:l["a"]},data:function(){var e=this.$route.params.treeid;return{query:{thedate:Object(n["b"])(new Date,"YYYYMMDD"),predate:Object(n["b"])(Date.now()-n["a"],"YYYYMMDD"),startshowtime:"0000",endshowtime:"2360",master_name:"",slave_name:e.split(".").map((function(e){return e.replace(/^\d+/,"")})).join("."),interface_name:"",master_ip:"",slave_ip:"",group_by:""},formatter:d,allItems:[],hour:-1,page:1,showChart:!0}},computed:{enableHourFilter:function(){return this.allItems.length&&this.allItems[0].show_time},filteredItems:function(){var e=this.hour;return e>=0&&this.enableHourFilter?this.allItems.filter((function(e){e.show_time.slice(0,2)})):this.allItems},itemsCount:function(){return this.filteredItems.length},pageCount:function(){return Math.ceil(this.filteredItems.length/c)},pagedItems:function(){return this.filteredItems.slice(c*(this.page-1),c*this.page)},charts:function(){return[{title:this.$t("monitor.table.total"),timeColumn:"show_time",dataColumns:[{name:"the_total_count",label:this.$t("monitor.table.curr")},{name:"pre_total_count",label:this.$t("monitor.table.contrast")}],data:this.allItems},{title:this.$t("monitor.table.a"),timeColumn:"show_time",dataColumns:[{name:"the_avg_time",label:this.$t("monitor.table.curr")},{name:"pre_avg_time",label:this.$t("monitor.table.contrast")}],data:this.allItems},{title:this.$t("monitor.table.b"),timeColumn:"show_time",dataColumns:[{name:"the_fail_rate",label:this.$t("monitor.table.curr")},{name:"pre_fail_rate",label:this.$t("monitor.table.contrast")}],data:this.allItems},{title:this.$t("monitor.table.c"),timeColumn:"show_time",dataColumns:[{name:"the_timeout_rate",label:this.$t("monitor.table.curr")},{name:"pre_timeout_rate",label:this.$t("monitor.table.contrast")}],data:this.allItems}]},chartOptions:function(){return{title:{show:!0,text:"".concat(this.$t("monitor.table.curr")," ").concat(this.$t("monitor.table.total"))},grid:{bottom:40,top:50},legend:{top:5},settings:{labelMap:{the_value:this.$t("monitor.property.property"),pre_value:this.$t("monitor.property.propertyC")},scale:[!0,!1]},data:{columns:["show_time","the_value","pre_value"],rows:this.allItems}}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t=this.$refs.chart&&this.$refs.chart.$loading.show(),a=this.$refs.table.$loading.show();return this.$ajax.getJSON("/server/api/tarsstat_monitor_data",this.query).then((function(o){t&&t.hide(),a.hide(),e.allItems=u(o)})).catch((function(o){t&&t.hide(),a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(o.message||o.err_msg))}))},groupBy:function(e,t){this.query.group_by=e,this.showChart=!1,t&&(t.show_time&&(this.query.startshowtime=t.show_time,this.query.endshowtime=t.show_time),t.interface_name&&"%"!=t.interface_name&&(this.query.interface_name=t.interface_name),t.master_ip&&"%"!=t.master_ip&&(this.query.master_ip=t.master_ip),t.master_name&&"%"!=t.master_name&&(this.query.master_name=t.master_name),t.slave_ip&&"%"!=t.slave_ip&&(this.query.slave_ip=t.slave_ip),t.slave_name&&"%"!=t.slave_name&&(this.query.slave_name=t.slave_name)),this.fetchData()},search:function(){delete this.query.group_by,this.showChart=!0,this.fetchData()},changePage:function(e){this.page=e}}},f=m,h=(a("8e4e"),a("2877")),p=Object(h["a"])(f,o,s,!1,null,null,null);t["a"]=p.exports},"8e4e":function(e,t,a){"use strict";var o=a("14a7"),s=a.n(o);s.a},"918a":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_config"},[e.configList?a("wrapper",{ref:"configListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.addConfig}},[e._v(e._s(e.$t("cfg.btn.add")))]),a("let-table",{attrs:{data:e.configList,title:e.$t("cfg.title.a"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:t.row.id},model:{value:e.checkedConfigId,callback:function(t){e.checkedConfigId=t},expression:"checkedConfigId"}},[a("span")])]}}],null,!1,3616594260)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.changeConfig(t.row,"configList")}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{on:{click:function(a){return e.deleteConfig(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))]),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("cfg.title.viewConf")))]),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.id)}}},[e._v(e._s(e.$t("pub.btn.history")))])]}}],null,!1,854184098)})],1)],1):e._e(),e.refFileList&&e.showOthers?a("wrapper",{ref:"refFileListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.openRefFileModal}},[e._v(e._s(e.$t("cfg.btn.addRef")))]),a("let-table",{attrs:{data:e.refFileList,title:e.$t("cfg.title.b"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.deleteRef(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))]),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("operate.view")))]),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.id)}}},[e._v(e._s(e.$t("pub.btn.history")))])]}}],null,!1,606143956)})],1)],1):e._e(),e.nodeConfigList&&e.showOthers?a("wrapper",{ref:"nodeConfigListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.pushNodeConfig}},[e._v(e._s(e.$t("cfg.btn.pushFile")))]),e.nodeConfigList.length?a("let-checkbox",{staticClass:"check-all",model:{value:e.nodeCheckAll,callback:function(t){e.nodeCheckAll=t},expression:"nodeCheckAll"}}):e._e(),a("let-table",{attrs:{data:e.nodeConfigList,title:e.$t("cfg.title.c"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-checkbox",{attrs:{label:t.row.id},model:{value:e.nodeCheckList,callback:function(t){e.nodeCheckList=t},expression:"nodeCheckList"}})]}}],null,!1,3731714217)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.changeConfig(t.row,"nodeConfigList")}}},[e._v(e._s(e.$t("cfg.table.modCfg")))]),a("let-table-operation",{on:{click:function(a){return e.showMergedDetail(t.row.id)}}},[e._v(e._s(e.$t("cfg.table.viewMerge")))]),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("cfg.table.viewIpContent")))]),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.id)}}},[e._v(e._s(e.$t("pub.btn.history")))]),a("let-table-operation",{on:{click:function(a){return e.handleRefFiles(t.row.id)}}},[e._v(e._s(e.$t("cfg.table.mangeRefFile")))])]}}],null,!1,1318823064)})],1)],1):e._e(),a("let-modal",{attrs:{title:e.configModal.isNew?e.$t("operate.title.add")+" "+e.$t("common.config"):e.$t("operate.title.update")+" "+e.$t("common.config"),width:"700px"},on:{"on-confirm":e.updateConfigFile,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model?a("let-form",{ref:"configForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("cfg.btn.fileName"),required:""}},[a("let-input",{attrs:{size:"small",disabled:!e.configModal.isNew,required:""},model:{value:e.configModal.model.filename,callback:function(t){e.$set(e.configModal.model,"filename",t)},expression:"configModal.model.filename"}})],1),e.configModal.isNew?e._e():a("let-form-item",{attrs:{label:e.$t("cfg.btn.reason"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.configModal.model.reason,callback:function(t){e.$set(e.configModal.model,"reason",t)},expression:"configModal.model.reason"}})],1),a("let-form-item",{attrs:{label:e.$t("cfg.btn.content"),required:""}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:16,required:""},model:{value:e.configModal.model.config,callback:function(t){e.$set(e.configModal.model,"config",t)},expression:"configModal.model.config"}})],1)],1):e._e()],1),a("let-modal",{attrs:{title:e.detailModal.title,width:"700px",footShow:!1},on:{close:e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model&&e.detailModal.model.table?a("let-table",{staticClass:"history-table",attrs:{data:e.detailModal.model.table,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"posttime"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.reason"),prop:"reason"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.content"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.showTableDeatil(t.row)}}},[e._v(e._s(e.$t("operate.view")))])]}}],null,!1,3538701521)})],1):e._e(),e.detailModal.model&&!e.detailModal.model.table||e.detailModal.model&&e.detailModal.model.table&&e.detailModal.model.detail?a("pre",[e._v(e._s(e.detailModal.model.detail||e.$t("cfg.msg.empty")))]):e._e(),a("div",{ref:"detailModalLoading",staticClass:"detail-loading"})],1),e.refFileModal.model?a("let-modal",{attrs:{title:this.$t("operate.title.add"),width:"700px"},on:{"on-confirm":e.addRefFile,close:e.closeRefFileModal},model:{value:e.refFileModal.show,callback:function(t){e.$set(e.refFileModal,"show",t)},expression:"refFileModal.show"}},[a("let-form",{ref:"refForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("cfg.msg.refFile"),required:""}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue"),required:""},model:{value:e.refFileModal.model.filename,callback:function(t){e.$set(e.refFileModal.model,"filename",t)},expression:"refFileModal.model.filename"}},e._l(e.refFileModal.model.fileList,(function(t){return a("let-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.filename))])})),1)],1)],1)],1):e._e(),a("let-modal",{attrs:{title:e.$t("cfg.table.mangeRefFile"),width:"700px",footShow:!1},on:{close:e.closeDetailModal},model:{value:e.nodeRefFileListModal.show,callback:function(t){e.$set(e.nodeRefFileListModal,"show",t)},expression:"nodeRefFileListModal.show"}},[e.nodeRefFileListModal.model?a("wrapper",[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.openNodeRefFileModal}},[e._v(e._s(e.$t("cfg.btn.addRef")))]),a("let-table",{attrs:{data:e.nodeRefFileListModal.model.refFileList,title:e.$t("cfg.title.b"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.deleteRef(t.row.id,"nodeRef",t.row.config_id)}}},[e._v(e._s(e.$t("operate.delete")))]),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("operate.view")))]),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.config_id)}}},[e._v(e._s(e.$t("pub.btn.history")))])]}}],null,!1,933040328)})],1)],1):e._e()],1),a("let-modal",{attrs:{width:"700px",footShow:!1},on:{close:e.closePushResultModal},model:{value:e.pushResultModal.show,callback:function(t){e.$set(e.pushResultModal,"show",t)},expression:"pushResultModal.show"}},[e.pushResultModal.model?a("let-table",{attrs:{data:e.pushResultModal.model,title:e.$t("serverList.table.th.result"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:0!==t.row.ret_code?"danger":"success"},[e._v(e._s(t.row.server_name))])]}}],null,!1,1546843640)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"result",class:0!==t.row.ret_code?"danger":"success"},[e._v(e._s(t.row.err_msg))])]}}],null,!1,3216099087)})],1):e._e()],1)],1)},s=[],r=(a("99af"),a("a15b"),a("d81d"),a("ac1f"),a("5319"),a("dcab")),n={name:"ServerConfig",components:{wrapper:r["a"]},data:function(){return{serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},checkedConfigId:"",configList:[],refFileList:null,nodeConfigList:null,nodeCheckList:[],configModal:{show:!1,isNew:!0,model:null},detailModal:{show:!1,title:"",model:null},refFileModal:{show:!1,model:{fileList:[]}},nodeRefFileListModal:{show:!1,model:null},pushResultModal:{show:!1,model:null}}},computed:{showOthers:function(){return 5===this.serverData.level},nodeCheckAll:{get:function(){return!(!this.nodeConfigList||!this.nodeConfigList.length)&&this.nodeCheckList.length===this.nodeConfigList.length},set:function(e){this.nodeCheckList=e?this.nodeConfigList.map((function(e){return e.id})):[]}}},watch:{checkedConfigId:function(){var e=this;this.$nextTick((function(){e.getRefFileList(),e.getNodeConfigList()}))}},methods:{getConfigList:function(e){var t=this,a=this.$refs.configListLoading.$loading.show();this.$ajax.getJSON("/server/api/config_file_list",e).then((function(e){a.hide(),t.configList=e,t.refFileList=[],t.nodeConfigList=[],e[0]&&e[0].id&&(t.checkedConfigId=e[0].id)})).catch((function(e){a.hide(),t.$confirm(e.err_msg||e.message||t.$t("common.error"),t.$t("common.retry"),t.$t("common.alert")).then((function(){t.getConfigList()}))}))},addConfig:function(){this.configModal.model={filename:"",config:""},this.configModal.isNew=!0,this.configModal.show=!0},changeConfig:function(e,t){this.configModal.model=Object.assign({reason:""},e),this.configModal.target=t,this.configModal.isNew=!1,this.configModal.show=!0},updateConfigFile:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show();this.configModal.model.filename=this.configModal.model.filename.replace(/(^\s*)|(\s*$)/g,"");var a=this.configModal.model;if(this.configModal.isNew){var o=Object.assign({application:this.serverData.application,level:this.serverData.level,server_name:this.serverData.server_name,set_name:this.serverData.set_name,set_area:this.serverData.set_area,set_group:this.serverData.set_group},a);this.$ajax.postJSON("/server/api/add_config_file",o).then((function(a){t.hide(),e.configList.unshift(a),1===e.configList.length&&(e.checkedConfigId=a.id),e.$tip.success(e.$t("common.success")),e.closeConfigModal()})).catch((function(){t.hide(),e.$tip.error(e.$t("common.error"))}))}else this.$ajax.postJSON("/server/api/update_config_file",{config:a.config,id:a.id,reason:a.reason}).then((function(a){t.hide(),e[e.configModal.target]=e[e.configModal.target].map((function(e){return e.id===a.id?a:e})),e.checkedConfigId===a.id&&(e.getRefFileList(),e.getNodeConfigList()),e.$tip.success(e.$t("common.success")),e.closeConfigModal()})).catch((function(){t.hide(),e.$tip.error(e.$t("common.error"))}))}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1},deleteConfig:function(e){var t=this;this.$confirm(this.$t("cfg.msg.confirmCfg"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_config_file",{id:e}).then((function(e){a.hide(),t.getConfigList(t.serverData),t.getNodeConfigList(),t.$tip.success(t.$t("common.success"))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))}))},getUnusedFileList:function(e){var t=this;this.showOthers&&this.$ajax.getJSON("/server/api/unused_config_file_list",{config_id:e,application:this.serverData.application}).then((function(e){t.refFileModal.model.fileList=e})).catch((function(e){t.refFileModal.model.fileList=[],t.$tip.error({title:t.$t("common.error"),message:e.err_msg||e.message||t.$t("common.networkErr")})}))},getRefFileList:function(){var e=this;if(this.showOthers){var t=this.$refs.refFileListLoading.$loading.show();this.$ajax.getJSON("/server/api/config_ref_list",{config_id:this.checkedConfigId}).then((function(a){t.hide(),a.map((function(e){var t=e.id;return e=Object.assign(e,e.reference),e.refrence_id=e.id,e.id=t,e})),e.refFileList=a})).catch((function(a){t.hide(),e.refFileList=[],e.$tip.error({title:e.$t("common.error"),message:a.err_msg||a.message||e.$t("common.networkErr")})}))}},openRefFileModal:function(){this.refFileModal.show=!0,this.refFileModal.isNodeRef=!1,this.getUnusedFileList(this.checkedConfigId)},openNodeRefFileModal:function(){this.refFileModal.show=!0,this.refFileModal.isNodeRef=!0,this.getUnusedFileList(this.refFileModal.id)},addRefFile:function(){var e=this;if(this.$refs.refForm.validate()){var t=this.$Loading.show();this.$ajax.getJSON("/server/api/add_config_ref",{config_id:this.refFileModal.isNodeRef?this.refFileModal.id:this.checkedConfigId,reference_id:this.refFileModal.model.filename}).then((function(a){t.hide(),e.refFileModal.show=!1,e.refFileModal.isNodeRef?e.getNodeRefFileList(e.refFileModal.id):e.getRefFileList()}))}},closeRefFileModal:function(){this.refFileModal.show=!1},deleteRef:function(e,t,a){var o=this;this.$confirm(this.$t("cfg.msg.confirm"),this.$t("common.alert")).then((function(){var s=o.$Loading.show();o.$ajax.getJSON("/server/api/delete_config_ref",{id:e}).then((function(e){s.hide(),"nodeRef"==t?o.getNodeRefFileList(a):o.getRefFileList(),o.$tip.success(o.$t("common.success"))}))}))},getNodeConfigList:function(){var e=this;if(this.showOthers){var t=this.$refs.nodeConfigListLoading.$loading.show(),a=Object.assign({config_id:this.checkedConfigId},this.serverData);this.$ajax.getJSON("/server/api/node_config_file_list",a).then((function(a){t.hide(),e.nodeConfigList=a})).catch((function(a){t.hide(),e.nodeConfigList=[],e.$tip.error({title:e.$t("common.error"),message:a.err_msg||a.message||e.$t("common.networkErr")})}))}},pushNodeConfig:function(){var e=this;if(this.nodeCheckList.length){var t=this.$Loading.show();this.$ajax.getJSON("/server/api/push_config_file",{ids:this.nodeCheckList.join(";")}).then((function(a){t.hide(),e.pushResultModal.model=a,e.pushResultModal.show=!0})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}else this.$tip.warning(this.$t("cfg.msg.selectNode"))},closePushResultModal:function(){this.pushResultModal.model=null,this.pushResultModal.show=!1},showDetail:function(e){this.detailModal.title=this.$t("cfg.title.viewConf"),this.detailModal.model={detail:e.config},this.detailModal.show=!0},showMergedDetail:function(e){var t=this;this.detailModal.title=this.$t("cfg.title.viewMerged"),this.detailModal.show=!0;var a=this.$loading.show({target:this.$refs.detailModalLoading});this.$ajax.getJSON("/server/api/merged_node_config",{id:e}).then((function(e){a.hide(),t.detailModal.model={detail:e}})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))},showHistory:function(e){var t=this;this.detailModal.title=this.$t("cfg.title.viewHistory"),this.detailModal.show=!0;var a=this.$loading.show({target:this.$refs.detailModalLoading});this.$ajax.getJSON("/server/api/config_file_history_list",{config_id:e}).then((function(e){a.hide(),t.detailModal.model={table:e.rows,detail:""}})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))},showTableDeatil:function(e){this.detailModal.model.detail=e.content},closeDetailModal:function(){this.detailModal.show=!1,this.detailModal.model=null},getNodeRefFileList:function(e){var t=this;this.$ajax.getJSON("/server/api/config_ref_list",{config_id:e}).then((function(e){e.map((function(e){var t=e.id;return e=Object.assign(e,e.reference),e.refrence_id=e.id,e.id=t,e})),t.nodeRefFileListModal.model={refFileList:e}})).catch((function(e){t.nodeRefFileListModal.model={refFileList:[]},t.$tip.error({title:t.$t("common.error"),message:e.err_msg||e.message||t.$t("common.networkErr")})}))},handleRefFiles:function(e){this.nodeRefFileListModal.show=!0,this.nodeRefFileListModal.model=null,this.refFileModal.id=e,this.getNodeRefFileList(e)}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getConfigList(this.serverData)}},i=n,l=(a("4201"),a("2877")),c=Object(l["a"])(i,o,s,!1,null,null,null);t["a"]=c.exports},9200:function(e,t,a){},"98c9":function(e,t,a){},"9c65":function(e,t,a){},a4e9:function(e,t,a){},a618:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("let-form",{attrs:{inline:"",itemWidth:"600px"},nativeOn:{submit:function(t){return t.preventDefault(),e.save(t)}}},[a("let-form-item",{attrs:{label:e.$t("user.op")}},[a("let-input",{attrs:{type:"textarea",disabled:!e.hasAuth},model:{value:e.operator,callback:function(t){e.operator=t},expression:"operator"}})],1),a("let-form-item",{attrs:{label:e.$t("user.dev")}},[a("let-input",{attrs:{type:"textarea",disabled:!e.hasAuth},model:{value:e.developer,callback:function(t){e.developer=t},expression:"developer"}})],1),a("let-form-item",[e.hasAuth?a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("common.submit")))]):e._e()],1)],1)],1)},s=[],r=(a("99af"),a("a15b"),{name:"ServerUserManage",data:function(){return{serverData:Object.assign({},this.$parent.getServerData()),developer:"",operator:"",hasAuth:!1}},mounted:function(){this.checkHasAuth(),this.getAuthList()},methods:{checkHasAuth:function(){var e=this;this.$ajax.getJSON("/server/api/has_auth",{application:this.serverData.application,server_name:this.serverData.server_name,role:"developer"}).then((function(t){console.log("checkHasAuth",t),e.hasAuth=t.has_auth||!1})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getAuthList:function(){var e=this;this.$ajax.getJSON("/server/api/get_auth_list",{application:this.serverData.application,server_name:this.serverData.server_name}).then((function(t){e.operator=(t.operator||[]).join(";"),e.developer=(t.developer||[]).join(";")})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},save:function(){var e=this,t=this.$Loading.show();this.$ajax.postJSON("/server/api/update_auth",{application:this.serverData.application,server_name:this.serverData.server_name,operator:this.operator,developer:this.developer}).then((function(a){t.hide(),e.$tip.success("".concat(e.$t("common.success")))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))}}}),n=r,i=(a("6744"),a("2877")),l=Object(i["a"])(n,o,s,!1,null,null,null);t["a"]=l.exports},aa73:function(e,t,a){"use strict";var o=a("57b6"),s=a.n(o);s.a},aade:function(e,t,a){"use strict";var o=a("70a0"),s=a.n(o);s.a},b3f5:function(e,t,a){"use strict";a("99af"),a("4160"),a("6d93");var o=a("a026"),s=a("7ad2");s["a"].ServerUrl.set("/pages"),s["a"].ResultHandler.set((function(e){return!(!e||200!==e.ret_code||null==e.data)})),["getJSON","postJSON"].forEach((function(e){var t=s["a"][e];s["a"]["_".concat(e)]=t,s["a"][e]=function(){for(var e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return t.call.apply(t,[null].concat(a)).then((function(e){return e.data}))}})),Object.defineProperty(o["default"].prototype,"$ajax",{get:function(){return s["a"]}}),t["a"]=s["a"]},bf5c:function(e,t,a){},dcab:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"section"},[e._t("default")],2)},s=[],r=(a("33c3"),a("2877")),n={},i=Object(r["a"])(n,o,s,!1,null,"2643216f",null);t["a"]=i.exports},e166:function(e,t,a){"use strict";var o=a("8b32"),s=a.n(o);s.a},e73b:function(e,t,a){"use strict";var o=a("4998"),s=a.n(o);s.a},e84a:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_manage"},[a("h4",[e._v(e._s(this.$t("serverList.title.serverList"))+" "),a("i",{staticClass:"icon iconfont el-icon-third-shuaxin",on:{click:e.getServerList}})]),e.serverList?a("let-table",{ref:"serverListLoading",attrs:{data:e.serverList,"empty-msg":e.$t("common.nodata"),stripe:""}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"buttonText",attrs:{href:"/static/logview/logview.html?app="+[t.row.application]+"&server_name="+[t.row.server_name]+"&node_name="+[t.row.node_name],title:"点击查看服务日志(view server logs)",target:"_blank"}},[e._v(" "+e._s(t.row.server_name)+" ")])]}}],null,!1,1650575184)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name",width:"140px"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.enableSet")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enable_set?a("p",{staticStyle:{"max-width":"200px"}},[e._v(" "+e._s(e.$t("common.set.setName"))+"："+e._s(t.row.set_name)),a("br"),e._v(" "+e._s(e.$t("common.set.setArea"))+"："+e._s(t.row.set_area)),a("br"),e._v(" "+e._s(e.$t("common.set.setGroup"))+"："+e._s(t.row.set_group)+" ")]):a("span",[e._v(e._s(e.$t("common.disable")))])]}}],null,!1,2963707083)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.setting_state?"status-active":"status-off"})]}}],null,!1,3224184510)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus"),width:"65px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.present_state?"status-active":"activating"===e.row.present_state?"status-activating":"status-off"})]}}],null,!1,4116932289)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.processID"),prop:"process_id",width:"80px"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"patch_version",width:"68px"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.handleNoPublishedTime(t.row.patch_time)))])]}}],null,!1,3144837894)}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServer(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{on:{click:function(a){return e.restartServer(t.row.id)}}},[e._v(e._s(e.$t("operate.restart")))]),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.stopServer(t.row.id)}}},[e._v(e._s(e.$t("operate.stop")))]),a("let-table-operation",{on:{click:function(a){return e.manageServant(t.row)}}},[e._v(e._s(e.$t("operate.servant")))]),a("let-table-operation",{on:{click:function(a){return e.showMoreCmd(t.row)}}},[e._v(e._s(e.$t("operate.more")))])]}}],null,!1,3118255582)})],1):e._e(),e.serverNotifyList&&e.showOthers?a("h4",[e._v(e._s(this.$t("serverList.title.serverStatus"))+" "),a("i",{staticClass:"icon iconfont",on:{click:function(t){return e.getServerNotifyList()}}},[e._v("")])]):e._e(),e.serverNotifyList&&e.showOthers?a("let-table",{ref:"serverNotifyListLoading",attrs:{data:e.serverNotifyList,stripe:"","empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"20%",title:e.$t("common.time"),prop:"notifytime"}}),a("let-table-column",{attrs:{width:"20%",title:e.$t("serverList.table.th.serviceID"),prop:"server_id"}}),a("let-table-column",{attrs:{width:"15%",title:e.$t("serverList.table.th.threadID"),prop:"thread_id"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result"),prop:"result"}})],1):e._e(),a("let-pagination",{staticStyle:{"margin-bottom":"32px"},attrs:{page:e.pageNum,total:e.total},on:{change:e.gotoPage}}),a("let-modal",{attrs:{title:e.$t("serverList.dlg.title.editService"),width:"800px",footShow:!(!e.configModal.model||!e.configModal.model.server_name)},on:{"on-confirm":e.saveConfig,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model&&e.configModal.model.server_name?a("let-form",{ref:"configForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("common.service")}},[e._v(e._s(e.configModal.model.server_name))]),a("let-form-item",{attrs:{label:e.$t("common.ip")}},[e._v(e._s(e.configModal.model.node_name))]),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.isBackup"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.yes")},{value:!1,text:e.$t("common.no")}]},model:{value:e.configModal.model.bak_flag,callback:function(t){e.$set(e.configModal.model,"bak_flag",t)},expression:"configModal.model.bak_flag"}})],1),a("let-form-item",{attrs:{label:e.$t("common.template"),required:""}},[e.configModal.model.templates&&e.configModal.model.templates.length?a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.template_name,callback:function(t){e.$set(e.configModal.model,"template_name",t)},expression:"configModal.model.template_name"}},e._l(e.configModal.model.templates,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1):a("span",[e._v(e._s(e.configModal.model.template_name))])],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.serviceType"),required:""}},[a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.server_type,callback:function(t){e.$set(e.configModal.model,"server_type",t)},expression:"configModal.model.server_type"}},e._l(e.serverTypes,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("serverList.table.th.enableSet"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.enable")},{value:!1,text:e.$t("common.disable")}]},model:{value:e.configModal.model.enable_set,callback:function(t){e.$set(e.configModal.model,"enable_set",t)},expression:"configModal.model.enable_set"}})],1),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setName"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setName")},model:{value:e.configModal.model.set_name,callback:function(t){e.$set(e.configModal.model,"set_name",t)},expression:"configModal.model.set_name"}})],1):e._e(),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setArea"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setArea"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setArea")},model:{value:e.configModal.model.set_area,callback:function(t){e.$set(e.configModal.model,"set_area",t)},expression:"configModal.model.set_area"}})],1):e._e(),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setGroup"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setGroup"),required:"",pattern:"^[0-9\\*]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setGroup")},model:{value:e.configModal.model.set_group,callback:function(t){e.$set(e.configModal.model,"set_group",t)},expression:"configModal.model.set_group"}})],1):e._e(),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.asyncThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.placeholder.thread"),required:"",pattern:"tars_nodejs"===e.configModal.model.server_type?"^[1-9][0-9]*$":"^([3-9]|[1-9][0-9]+)$","pattern-tip":e.$t("serverList.dlg.placeholder.thread")},model:{value:e.configModal.model.async_thread_num,callback:function(t){e.$set(e.configModal.model,"async_thread_num",t)},expression:"configModal.model.async_thread_num"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.defaultPath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.base_path,callback:function(t){e.$set(e.configModal.model,"base_path",t)},expression:"configModal.model.base_path"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.exePath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.exe_path,callback:function(t){e.$set(e.configModal.model,"exe_path",t)},expression:"configModal.model.exe_path"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.startScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.start_script_path,callback:function(t){e.$set(e.configModal.model,"start_script_path",t)},expression:"configModal.model.start_script_path"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.stopScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.stop_script_path,callback:function(t){e.$set(e.configModal.model,"stop_script_path",t)},expression:"configModal.model.stop_script_path"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.monitorScript"),itemWidth:"724px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.monitor_script_path,callback:function(t){e.$set(e.configModal.model,"monitor_script_path",t)},expression:"configModal.model.monitor_script_path"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.privateTemplate"),labelWidth:"150px",itemWidth:"724px"}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:4},model:{value:e.configModal.model.profile,callback:function(t){e.$set(e.configModal.model,"profile",t)},expression:"configModal.model.profile"}})],1)],1):a("div",{ref:"configFormLoading",staticClass:"loading-placeholder"})],1),a("let-modal",{attrs:{title:e.$t("serverList.table.servant.title"),width:"1200px",footShow:!1},on:{close:e.closeServantModal},model:{value:e.servantModal.show,callback:function(t){e.$set(e.servantModal,"show",t)},expression:"servantModal.show"}},[a("let-button",{staticClass:"tbm16",attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.configServant()}}},[e._v(e._s(e.$t("operate.add"))+" Servant")]),e.servantModal.model?a("let-table",{attrs:{data:e.servantModal.model,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("operate.servant"),prop:"servant"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.adress"),prop:"endpoint"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.thread"),prop:"thread_num"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxConnecttions"),prop:"max_connections"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxQueue"),prop:"queuecap"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),prop:"queuetimeout"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServant(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.deleteServant(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,271550836)})],1):a("div",{ref:"servantModalLoading",staticClass:"loading-placeholder"})],1),a("let-modal",{attrs:{title:e.servantDetailModal.isNew?e.$t("operate.title.add")+" Servant":e.$t("operate.title.update")+" Servant",width:"800px",footShow:!!e.servantDetailModal.model},on:{"on-confirm":e.saveServantDetail,close:e.closeServantDetailModal,"on-cancel":e.closeServantDetailModal},model:{value:e.servantDetailModal.show,callback:function(t){e.$set(e.servantDetailModal,"show",t)},expression:"servantDetailModal.show"}},[e.servantDetailModal.model?a("let-form",{ref:"servantDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("serverList.servant.appService"),itemWidth:"724px"}},[a("span",[e._v(e._s(e.servantDetailModal.model.application)+"·"+e._s(e.servantDetailModal.model.server_name))])]),a("let-form-item",{attrs:{label:e.$t("serverList.servant.objName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.c"),required:"","pattern-tip":e.$t("serverList.servant.obj")},model:{value:e.servantDetailModal.model.obj_name,callback:function(t){e.$set(e.servantDetailModal.model,"obj_name",t)},expression:"servantDetailModal.model.obj_name"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.numOfThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.thread"),required:"",pattern:"^[1-9][0-9]*$","pattern-tip":e.$t("serverList.servant.thread")},model:{value:e.servantDetailModal.model.thread_num,callback:function(t){e.$set(e.servantDetailModal.model,"thread_num",t)},expression:"servantDetailModal.model.thread_num"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.table.servant.adress"),required:""}},[a("let-input",{ref:"endpoint",attrs:{size:"small",placeholder:"tcp -h 127.0.0.1 -t 60000 -p 12000",required:"",extraTip:e.isEndpointValid?"":e.$t("serverList.servant.error")},model:{value:e.servantDetailModal.model.endpoint,callback:function(t){e.$set(e.servantDetailModal.model,"endpoint",t)},expression:"servantDetailModal.model.endpoint"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.table.servant.nodeName"),required:""}},[a("let-input",{ref:"node_name",attrs:{size:"small",placeholder:"127.0.0.1",required:"",disabled:!e.servantDetailModal.isNew},model:{value:e.servantDetailModal.model.node_name,callback:function(t){e.$set(e.servantDetailModal.model,"node_name",t)},expression:"servantDetailModal.model.node_name"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.maxConnecttions"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.max_connections,callback:function(t){e.$set(e.servantDetailModal.model,"max_connections",t)},expression:"servantDetailModal.model.max_connections"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.lengthOfQueue"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuecap,callback:function(t){e.$set(e.servantDetailModal.model,"queuecap",t)},expression:"servantDetailModal.model.queuecap"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.queueTimeout"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuetimeout,callback:function(t){e.$set(e.servantDetailModal.model,"queuetimeout",t)},expression:"servantDetailModal.model.queuetimeout"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.allowIP")}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.allow_ip,callback:function(t){e.$set(e.servantDetailModal.model,"allow_ip",t)},expression:"servantDetailModal.model.allow_ip"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.protocol"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:"tars",text:"TARS"},{value:"not_tars",text:e.$t("serverList.servant.notTARS")}]},model:{value:e.servantDetailModal.model.protocol,callback:function(t){e.$set(e.servantDetailModal.model,"protocol",t)},expression:"servantDetailModal.model.protocol"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.treatmentGroup"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.handlegroup,callback:function(t){e.$set(e.servantDetailModal.model,"handlegroup",t)},expression:"servantDetailModal.model.handlegroup"}})],1)],1):e._e()],1),a("let-modal",{staticClass:"more-cmd",attrs:{title:e.$t("operate.title.more"),width:"700px"},on:{"on-confirm":e.invokeMoreCmd,close:e.closeMoreCmdModal,"on-cancel":e.closeMoreCmdModal},model:{value:e.moreCmdModal.show,callback:function(t){e.$set(e.moreCmdModal,"show",t)},expression:"moreCmdModal.show"}},[e.moreCmdModal.model?a("let-form",{ref:"moreCmdForm"},[a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"setloglevel"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.logLevel")))]),a("let-select",{attrs:{size:"small",disabled:"setloglevel"!==e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.setloglevel,callback:function(t){e.$set(e.moreCmdModal.model,"setloglevel",t)},expression:"moreCmdModal.model.setloglevel"}},e._l(e.logLevels,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"loadconfig"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.pushFile")))]),a("let-select",{attrs:{size:"small",placeholder:e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length?e.$t("pub.dlg.defaultValue"):e.$t("pub.dlg.noConfFile"),disabled:!(e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length)||"loadconfig"!==e.moreCmdModal.model.selected,required:"loadconfig"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.loadconfig,callback:function(t){e.$set(e.moreCmdModal.model,"loadconfig",t)},expression:"moreCmdModal.model.loadconfig"}},e._l(e.moreCmdModal.model.configs,(function(t){return a("let-option",{key:t.filename,attrs:{value:t.filename}},[e._v(e._s(t.filename))])})),1)],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"command"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.sendCommand")))]),a("let-input",{attrs:{size:"small",disabled:"command"!==e.moreCmdModal.model.selected,required:"command"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.command,callback:function(t){e.$set(e.moreCmdModal.model,"command",t)},expression:"moreCmdModal.model.command"}})],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"connection"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.serviceLink")))])],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{staticClass:"danger",attrs:{label:"undeploy_tars"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("operate.undeploy"))+" "+e._s(e.$t("common.service")))])],1)],1):e._e()],1)],1)},s=[],r=(a("99af"),a("4de4"),a("7db0"),a("a15b"),a("d81d"),a("d3b7"),a("ac1f"),a("5319"),a("1276"),a("5530")),n={name:"ServerManage",data:function(){return{serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},serverList:[],serverNotifyList:[],getServerNotifyListTimer:0,pageNum:1,pageSize:20,total:1,serverTypes:["tars_cpp","tars_java","tars_php","tars_nodejs","not_tars","tars_go"],configModal:{show:!1,model:null},servantModal:{show:!1,model:null,currentServer:null},servantDetailModal:{show:!1,isNew:!0,model:null},logLevels:["NONE","DEBUG","INFO","WARN","ERROR"],moreCmdModal:{show:!1,model:null,currentServer:null},failCount:0}},computed:{showOthers:function(){return 5===this.serverData.level},isEndpointValid:function(){return!(!this.servantDetailModal.model||!this.servantDetailModal.model.endpoint)&&this.checkServantEndpoint(this.servantDetailModal.model.endpoint)}},methods:{getServerList:function(){var e=this,t=this.$refs.serverListLoading.$loading.show();this.$ajax.getJSON("/server/api/server_list",{tree_node_id:this.$route.params.treeid}).then((function(a){t.hide(),e.serverList=a})).catch((function(a){t.hide(),e.$confirm(a.err_msg||a.message||e.$t("serverList.msg.fail"),e.$t("common.alert")).then((function(){e.getServerList()}))}))},getServerNotifyList:function(e){var t=this;this.showOthers&&(e||(e=this.pageNum||1),this.$ajax.getJSON("/server/api/server_notify_list",{tree_node_id:this.$route.params.treeid,page_size:this.pageSize,curr_page:e}).then((function(a){t.pageNum=e,t.total=Math.ceil(a.count/t.pageSize),t.serverNotifyList=a.rows})).catch((function(e){t.$tip.error("".concat(t.$t("serverList.restart.failed"),": ").concat(e.err_msg||e.message))})))},gotoPage:function(e){this.getServerNotifyList(e)},getTemplateList:function(){var e=this;this.$ajax.getJSON("/server/api/template_name_list").then((function(t){e.configModal.model?e.configModal.model.templates=t:e.configModal.model={templates:t}})).catch((function(t){e.$tip.error("".concat(e.$t("serverList.restart.failed"),": ").concat(t.err_msg||t.message))}))},getServerConfig:function(e){var t=this,a=this.$loading.show({target:this.$refs.configFormLoading});this.$ajax.getJSON("/server/api/server",{id:e}).then((function(e){a.hide(),t.configModal.model?t.configModal.model=Object.assign({},t.configModal.model,e):(e.templates=[],t.configModal.model=e)})).catch((function(e){a.hide(),t.closeConfigModal(),t.$tip.error("".concat(t.$t("serverList.restart.failed"),": ").concat(e.err_msg||e.message))}))},configServer:function(e){this.configModal.show=!0,this.getTemplateList(),this.getServerConfig(e)},saveConfig:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show();this.$ajax.postJSON("/server/api/update_server",Object(r["a"])({isBak:this.configModal.model.bak_flag},this.configModal.model)).then((function(a){t.hide(),e.serverList=e.serverList.map((function(e){return e.id===a.id?a:e})),e.closeConfigModal(),e.$tip.success(e.$t("serverList.restart.success"))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("serverList.restart.failed"),": ").concat(a.message||a.err_msg))}))}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1,this.configModal.model=null},checkTaskStatus:function(e,t){var a=this;return new Promise((function(o,s){a.$ajax.getJSON("/server/api/task",{task_no:e}).then((function(t){1===t.status||0===t.status?setTimeout((function(){o(a.checkTaskStatus(e))}),3e3):2===t.status?o("taskid: ".concat(t.task_no)):s(new Error("taskid: ".concat(t.task_no)))})).catch((function(r){t?s(new Error(r.err_msg||r.message||a.$t("common.networkErr"))):setTimeout((function(){o(a.checkTaskStatus(e,!0))}),3e3)}))}))},addTask:function(e,t,a){var o=this,s=this.$Loading.show();this.$ajax.postJSON("/server/api/add_task",{serial:!0,items:[{server_id:e,command:t}]}).then((function(e){return o.checkTaskStatus(e).then((function(e){s.hide(),o.getServerList(),o.$tip.success({title:a.success,message:e})})).catch((function(e){throw e}))})).catch((function(e){s.hide(),o.getServerList(),o.$tip.error({title:a.error,message:e.err_msg||e.message||o.$t("common.networkErr")})}))},restartServer:function(e){this.addTask(e,"restart",{success:this.$t("serverList.restart.success"),error:this.$t("serverList.restart.failed")})},stopServer:function(e){var t=this;this.$confirm(this.$t("serverList.stopService.msg.stopService"),this.$t("common.alert")).then((function(){t.addTask(e,"stop",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")})}))},undeployServer:function(e){var t=this;"active"===e.present_state?this.$tip.error("".concat(this.$t("serverList.tips.undeploy"))):this.$confirm(this.$t("serverList.dlg.msg.undeploy"),this.$t("common.alert")).then((function(){t.addTask(e.id,"undeploy_tars",{success:t.$t("serverList.undeploy.success"),error:t.$t("serverList.undeploy.failed")}),t.closeMoreCmdModal()}))},manageServant:function(e){var t=this;this.servantModal.show=!0;var a=this.$loading.show({target:this.$refs.servantModalLoading});this.$ajax.getJSON("/server/api/adapter_conf_list",{id:e.id}).then((function(o){a.hide(),t.servantModal.model=o,t.servantModal.currentServer=e})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("serverList.restart.failed"),": ").concat(e.err_msg||e.message))}))},closeServantModal:function(){this.servantModal.show=!1,this.servantModal.model=null,this.servantModal.currentServer=null},configServant:function(e){if(this.servantDetailModal.model={application:this.servantModal.currentServer.application,server_name:this.servantModal.currentServer.server_name,obj_name:"",node_name:"",endpoint:"",servant:"",thread_num:"",max_connections:"200000",queuecap:"10000",queuetimeout:"60000",allow_ip:"",protocol:"not_tars",handlegroup:""},this.servantDetailModal.isNew=!0,e){var t=this.servantModal.model.find((function(t){return t.id===e}));t.obj_name=t.servant.split(".")[2],this.servantDetailModal.model=Object.assign({},this.servantDetailModal.model,t),this.servantDetailModal.isNew=!1}this.servantDetailModal.show=!0},closeServantDetailModal:function(){this.$refs.servantDetailForm&&this.$refs.servantDetailForm.resetValid(),this.servantDetailModal.show=!1,this.servantDetailModal.model=null},checkServantEndpoint:function(e){var t=e.split(/\s-/),a=/^tcp|udp|ssl$/i,o=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/i,s=/^h\s[^\s]+/i,r=/^t\s([1-9]|[1-9]\d+)$/i,n=/^p\s\d{2,5}$/i,i=!0;if(a.test(t[0])){for(var l=0,c=1;c<t.length;c++){if(s&&s.test(t[c])){l++;var d=t[c].split(/\s/)[1];o.test(d)&&(this.servantDetailModal.model.node_name=d),s=null}if(r&&r.test(t[c])&&(l++,r=null),n&&n.test(t[c])){var u=t[c].substring(2);u<0||u>65535||l++,n=null}}i=3===l}else i=!1;return i},saveServantDetail:function(){var e=this;if(this.$refs.servantDetailForm.validate()){var t=this.$Loading.show();if(this.servantDetailModal.isNew){var a=this.servantDetailModal.model;a.servant=[a.application,a.server_name,a.obj_name].join("."),this.$ajax.postJSON("/server/api/add_adapter_conf",a).then((function(a){t.hide(),e.servantModal.model.unshift(a),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}else this.servantDetailModal.model.servant=this.servantDetailModal.model.application+"."+this.servantDetailModal.model.server_name+"."+this.servantDetailModal.model.obj_name,this.$ajax.postJSON("/server/api/update_adapter_conf",this.servantDetailModal.model).then((function(a){t.hide(),e.servantModal.model=e.servantModal.model.map((function(e){return e.id===a.id?a:e})),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}},deleteServant:function(e){var t=this;this.$confirm(this.$t("serverList.servant.a"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_adapter_conf",{id:e}).then((function(o){a.hide(),t.servantModal.model=t.servantModal.model.filter((function(t){return t.id!==e})),t.$tip.success(t.$t("common.success"))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))}))},showMoreCmd:function(e){var t=this;this.moreCmdModal.model={selected:"setloglevel",setloglevel:"NONE",loadconfig:"",command:"",configs:null},this.moreCmdModal.unwatch=this.$watch("moreCmdModal.model.selected",(function(){t.$refs.moreCmdForm&&t.$refs.moreCmdForm.resetValid()})),this.moreCmdModal.show=!0,this.moreCmdModal.currentServer=e,this.$ajax.getJSON("/server/api/config_file_list",{level:5,application:e.application,server_name:e.server_name}).then((function(e){t.moreCmdModal.model&&(t.moreCmdModal.model.configs=e)})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))},sendCommand:function(e,t,a){var o=this,s=this.$Loading.show();this.$ajax.getJSON("/server/api/send_command",{server_ids:e,command:t}).then((function(e){s.hide();var t=e[0].err_msg.replace(/\n/g,"<br>");if(0!==e[0].ret_code)throw new Error(t);var r={title:o.$t("common.success"),message:t};a&&(r.duration=0),o.$tip.success(r)})).catch((function(e){s.hide(),o.$tip.error({title:o.$t("common.error"),message:e.err_msg||e.message})}))},invokeMoreCmd:function(){var e=this.moreCmdModal.model,t=this.moreCmdModal.currentServer;"undeploy_tars"===e.selected?this.undeployServer(t):"setloglevel"===e.selected?this.sendCommand(t.id,"tars.setloglevel ".concat(e.setloglevel)):"loadconfig"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,"tars.loadconfig ".concat(e.loadconfig)):"command"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,e.command):"connection"===e.selected&&this.sendCommand(t.id,"tars.connection",!0)},closeMoreCmdModal:function(){this.$refs.moreCmdForm&&this.$refs.moreCmdForm.resetValid(),this.moreCmdModal.unwatch&&this.moreCmdModal.unwatch(),this.moreCmdModal.show=!1,this.moreCmdModal.model=null},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getServerList(),this.getServerNotifyList(1)},beforeRouteEnter:function(e,t,a){a(a((function(e){e.getServerNotifyList(1)})))},beforeRouteUpdate:function(e,t,a){a(a((function(e){e.getServerNotifyList(1)})))},linkDownload:function(e){window.open(e,"_blank")}},i=n,l=(a("2e66"),a("2877")),c=Object(l["a"])(i,o,s,!1,null,null,null);t["a"]=c.exports},f51c:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return d}));a("d3b7"),a("25f0");var o=a("a026"),s=a("a925"),r=a("00e7"),n=a.n(r),i=a("7ad2");o["default"].use(s["a"]),o["default"].use(n.a);var l=new s["a"]({}),c=[];function d(){return new Promise((function(e,t){i["a"].getJSON("/server/api/get_locale").then((function(t){var a=n.a.get("locale");if("[object Object]"==Object.prototype.toString.call(t)){for(var o in t)l.setLocaleMessage(o,t[o]),c.push({localeCode:o,localeName:t[o]["localeName"],localeMessages:t});a=t[a]?a:"cn",c=t}l.locale=a,e()})).catch((function(e){t(e)}))}))}}}]);